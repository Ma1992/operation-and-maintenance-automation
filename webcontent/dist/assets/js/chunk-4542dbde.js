(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4542dbde","chunk-2d0aa9b6"],{1276:function(t,e,i){"use strict";var o=i("d784"),s=i("44e7"),a=i("825a"),r=i("1d80"),n=i("4840"),l=i("8aa5"),c=i("50c4"),m=i("14c3"),p=i("9263"),u=i("d039"),f=[].push,v=Math.min,h=4294967295,d=!u((function(){return!RegExp(h,"y")}));o("split",2,(function(t,e,i){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,i){var o=String(r(this)),a=void 0===i?h:i>>>0;if(0===a)return[];if(void 0===t)return[o];if(!s(t))return e.call(o,t,a);var n,l,c,m=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,d=new RegExp(t.source,u+"g");while(n=p.call(d,o)){if(l=d.lastIndex,l>v&&(m.push(o.slice(v,n.index)),n.length>1&&n.index<o.length&&f.apply(m,n.slice(1)),c=n[0].length,v=l,m.length>=a))break;d.lastIndex===n.index&&d.lastIndex++}return v===o.length?!c&&d.test("")||m.push(""):m.push(o.slice(v)),m.length>a?m.slice(0,a):m}:"0".split(void 0,0).length?function(t,i){return void 0===t&&0===i?[]:e.call(this,t,i)}:e,[function(e,i){var s=r(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,s,i):o.call(String(s),e,i)},function(t,s){var r=i(o,t,this,s,o!==e);if(r.done)return r.value;var p=a(t),u=String(this),f=n(p,RegExp),g=p.unicode,b=(p.ignoreCase?"i":"")+(p.multiline?"m":"")+(p.unicode?"u":"")+(d?"y":"g"),_=new f(d?p:"^(?:"+p.source+")",b),y=void 0===s?h:s>>>0;if(0===y)return[];if(0===u.length)return null===m(_,u)?[u]:[];var C=0,w=0,k=[];while(w<u.length){_.lastIndex=d?w:0;var S,x=m(_,d?u:u.slice(w));if(null===x||(S=v(c(_.lastIndex+(d?0:w)),u.length))===C)w=l(u,w,g);else{if(k.push(u.slice(C,w)),k.length===y)return k;for(var T=1;T<=x.length-1;T++)if(k.push(x[T]),k.length===y)return k;w=C=S}}return k.push(u.slice(C)),k}]}),!d)},"6dac":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}})],1),i("div",{staticClass:"container"},[i("div",{staticStyle:{"margin-bottom":"15px"}},[i("span",[t._v("华为云环境：")]),i("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"请选择华为云环境"},on:{change:t.handleSelectHuaweiEnv},model:{value:t.huaweiyun_env,callback:function(e){t.huaweiyun_env=e},expression:"huaweiyun_env"}},t._l(t.huaweiyun_options,(function(t){return i("el-option",{key:t.id,attrs:{label:t.hw_ip,value:t.hw_ip}})})),1)],1),i("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[i("div",[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.handleCreate}},[t._v("创建虚拟机")])],1),i("div",[i("el-input",{staticStyle:{width:"200px","margin-bottom":"15px"},attrs:{type:"text",placeholder:"请输入虚拟机名称",clearable:""},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")])],1)]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","max-height":"600"}},[i("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),i("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),i("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.statusFormat,align:"center"}}),i("el-table-column",{attrs:{prop:"vmType",label:"类型",formatter:t.typeFormat,align:"center"}}),i("el-table-column",{attrs:{prop:"arch",label:"CPU架构",align:"center"}}),i("el-table-column",{attrs:{prop:"ip",label:"IP地址",align:"center"}}),i("el-table-column",{attrs:{prop:"clusterName",label:"所属集群",align:"center"}}),i("el-table-column",{attrs:{prop:"hostName",label:"所属主机",align:"center"}}),i("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["stopped"===e.row.status?i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){return t.handleStartVms(e.$index,e.row)}}},[t._v("启动")]):t._e(),"running"===e.row.status?i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){return t.handleStopVms(e.$index,e.row)}}},[t._v("停止")]):t._e(),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){return t.handleDeleteVms(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal},on:{"current-change":t.handlePageChange}})],1)],1),i("el-dialog",{attrs:{title:"创建虚拟机",visible:t.editVisible,"close-on-click-modal":!1,width:"65%"},on:{"update:visible":function(e){t.editVisible=e}}},[i("div",{staticClass:"vm-dialog-div"},[i("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"100px",labelPosition:"left"}},[i("el-row",{attrs:{span:24}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"border-left"},[i("el-steps",{attrs:{direction:"vertical",active:t.active,"finish-status":"success"}},t._l(t.step_options,(function(t){return i("el-step",{key:t.value,attrs:{title:t.label}})})),1)],1)]),i("el-col",{attrs:{span:18}},[0===this.active?i("el-row",[i("span",{staticStyle:{"margin-left":"20px"}},[t._v("您要如何创建虚拟机？")]),i("div",{staticClass:"border-right"},[i("el-tabs",{staticStyle:{height:"200px"},attrs:{"tab-position":"left",type:"card"},on:{"tab-click":t.handleStepOPtions},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"创建新虚拟机",name:"0"}},[t._v("此选项将指导您完成创建新虚拟机的过程。您将可以自定义CPU、内存、网卡和磁盘。创建之后将需要安装客户机操作系统。")]),i("el-tab-pane",{attrs:{label:"使用模板部署虚拟机",name:"1"}},[t._v("此选项将指导您完成从模板部署虚拟机的过程。模板是最佳配置的虚拟机映像，使您轻松创建可以立即使用的虚拟机。您必须具有一个模板才能继续使用此选项。")])],1)],1)]):t._e(),i("div",{staticClass:"border-right-next"},["0"===this.activeName?i("el-row",[1===this.active?i("el-row",[i("el-form-item",{attrs:{label:"名称：",prop:"name","label-width":"150px"}},[i("el-input",{staticClass:"create-input",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"描述：",prop:"description","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{type:"textarea"},model:{value:t.form.descripttion,callback:function(e){t.$set(t.form,"descripttion",e)},expression:"form.descripttion"}})],1),i("el-form-item",{attrs:{label:"选择虚拟机位置：",prop:"parentObjUrn","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{disabled:""},model:{value:t.parentObjUrnTo,callback:function(e){t.parentObjUrnTo=e},expression:"parentObjUrnTo"}}),i("el-button",{on:{click:t.handleSelectPosition}},[t._v("选择")])],1),i("el-form-item",{attrs:{label:"选择计算资源：",prop:"location","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{disabled:""},model:{value:t.locationTo,callback:function(e){t.locationTo=e},expression:"locationTo"}}),i("el-button",{on:{click:t.handleSelectCluster}},[t._v("选择")]),i("el-checkbox",{staticStyle:{"padding-left":"15px"},attrs:{disabled:t.checked_disabled},model:{value:t.form.isBindingHost,callback:function(e){t.$set(t.form,"isBindingHost",e)},expression:"form.isBindingHost"}},[t._v("与所选主机绑定")])],1),i("el-form-item",{attrs:{label:"操作系统类型：","label-width":"150px"}},[i("el-radio-group",{on:{change:t.selectOsType},model:{value:t.form.osOptions.osType,callback:function(e){t.$set(t.form.osOptions,"osType",e)},expression:"form.osOptions.osType"}},t._l(t.os_type_arr,(function(e){return i("el-radio",{key:e.id,attrs:{label:e.label}},[t._v(t._s(e.label))])})),1)],1),i("el-form-item",{attrs:{label:"操作系统版本号：","label-width":"150px"}},[i("el-select",{staticClass:"create-input",attrs:{filterable:"",placeholder:"请选择操作系统版本"},model:{value:t.form.osOptions.osVersion,callback:function(e){t.$set(t.form.osOptions,"osVersion",e)},expression:"form.osOptions.osVersion"}},t._l(t.os_version_options,(function(t){return i("el-option",{key:t.os_id,attrs:{label:t.os_version,value:t.os_id}})})),1)],1),"其他"===t.form.osOptions.osType?i("el-form-item",{attrs:{label:"操作系统名称：","label-width":"150px"}},[i("el-input",{staticClass:"create-input",model:{value:t.form.osOptions.osName,callback:function(e){t.$set(t.form.osOptions,"osName",e)},expression:"form.osOptions.osName"}})],1):t._e()],1):2===this.active?i("el-row",[i("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.storeTableData,border:"","highlight-current-row":"","max-height":"600"},on:{"current-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),i("el-table-column",{attrs:{prop:"actualFreeSizeGB",label:"可用容量(GB)",align:"center"}}),i("el-table-column",{attrs:{prop:"storageType",formatter:t.storageTypeFormat,label:"类型",align:"center"}})],1)],1):3===this.active?i("el-row",[i("el-tabs",{on:{"tab-click":t.handleVMClick},model:{value:t.activeVMName,callback:function(e){t.activeVMName=e},expression:"activeVMName"}},[i("el-tab-pane",{attrs:{label:"硬件",name:"0"}},[i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.cpu_arrow_icon,on:{click:t.showCPUInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"CPU","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:36},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.cpu.quantity,callback:function(e){t.$set(t.form.vmConfig.cpu,"quantity",e)},expression:"form.vmConfig.cpu.quantity"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 1-36"),i("br"),t._v("建议虚拟机的内核数是每个插槽的内核数"),i("br"),t._v("的整数倍。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-collapse-transition",[t.show_cpu?i("div",[i("el-form-item",{attrs:{label:"份额","label-width":"135px"}},[i("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"份额"},on:{change:t.handleCpuShare},model:{value:t.cpu_share,callback:function(e){t.cpu_share=e},expression:"cpu_share"}},t._l(t.cpu_share_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-input",{staticStyle:{width:"100px"},attrs:{disabled:t.cpu_share_disabled},model:{value:t.form.vmConfig.cpu.weight,callback:function(e){t.$set(t.form.vmConfig.cpu,"weight",e)},expression:"form.vmConfig.cpu.weight"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("描述：定义多个虚拟机在竞争物理CPU资"),i("br"),t._v("源时按比例分配，份额越高的虚拟机，竞"),i("br"),t._v("争物理CPU时获取的资源越多。 "),i("br"),t._v("范围："),i("br"),t._v(" 低：内核数*250"),i("br"),t._v(" 中：内核数*500"),i("br"),t._v(" 高：内核数*1000"),i("br"),t._v(" 自定义：2~255000")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"每个插槽内核数","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:36},model:{value:t.form.vmConfig.cpu.coresPerSocket,callback:function(e){t.$set(t.form.vmConfig.cpu,"coresPerSocket",e)},expression:"form.vmConfig.cpu.coresPerSocket"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 1-36"),i("br"),t._v("插槽数:"+t._s(Math.ceil(t.form.vmConfig.cpu.quantity/t.form.vmConfig.cpu.coresPerSocket)))]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"预留(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:4400},model:{value:t.form.vmConfig.cpu.reservation,callback:function(e){t.$set(t.form.vmConfig.cpu,"reservation",e)},expression:"form.vmConfig.cpu.reservation"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 0-"+t._s(2200*t.form.vmConfig.cpu.quantity)),i("br"),t._v(" 定义了多个虚拟机竞争物理CPU资源的时"),i("br"),t._v("候分配的最低计算资源。如果指定CPU的"),i("br"),t._v("预留值，需要排除故障和已经停止的主"),i("br"),t._v("机。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"限制(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:4400},model:{value:t.form.vmConfig.cpu.limit,callback:function(e){t.$set(t.form.vmConfig.cpu,"limit",e)},expression:"form.vmConfig.cpu.limit"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("0表示不限"),i("br"),t._v(" 控制虚拟机占用物理CPU资源的上限。以"),i("br"),t._v("一个两CPU的虚拟机为例，如果设置该虚"),i("br"),t._v("拟机CPU上限为3000MHz，则该虚拟机的"),i("br"),t._v("两个虚拟CPU计算能力被限制为"),i("br"),t._v("1500MHz。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.mem_arrow_icon,on:{click:t.showMemInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"内存","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:4096},on:{change:t.handleMemChange},model:{value:t.form.vmConfig.memory.quantityMB,callback:function(e){t.$set(t.form.vmConfig.memory,"quantityMB",e)},expression:"form.vmConfig.memory.quantityMB"}}),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"}},[t._v("GB")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("32位系统无法充分利用4G内存，建议32"),i("br"),t._v("位系统无需配满4G内存，可以配置"),i("br"),t._v("3583MB内存（约3.5GB）。")]),i("i",{staticClass:"el-icon-warning",staticStyle:{color:"#66b1ff"}})])],1),i("el-collapse-transition",[t.show_mem?i("div",[i("el-form-item",{attrs:{label:"份额","label-width":"135px"}},[i("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"份额"},on:{change:t.handleMemShare},model:{value:t.mem_share,callback:function(e){t.mem_share=e},expression:"mem_share"}},t._l(t.cpu_share_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-input",{staticClass:"create-input",staticStyle:{width:"100px"},attrs:{disabled:t.mem_share_disabled},model:{value:t.form.vmConfig.memory.weight,callback:function(e){t.$set(t.form.vmConfig.memory,"weight",e)},expression:"form.vmConfig.memory.weight"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("低：内存大小 * 5"),i("br"),t._v(" 中：内存大小 * 10"),i("br"),t._v(" 高：内存大小 * 20"),i("br"),t._v(" 自定义：1~83886080")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"预留(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{disabled:t.mem_reserve_disabled,min:0,max:4096},model:{value:t.form.vmConfig.memory.reservation,callback:function(e){t.$set(t.form.vmConfig.memory,"reservation",e)},expression:"form.vmConfig.memory.reservation"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 0-"+t._s(1024*t.form.vmConfig.memory.quantityMB)),i("br"),t._v(" 当集群的内存复用开启时,内存预留值生"),i("br"),t._v("效;"),i("br"),t._v(" 具有PCI直通设备(包括SRIOV)的虚拟机"),i("br"),t._v("或是虚拟机所在主机配置了内存盘模式，"),i("br"),t._v("内存预留值必须和内存规格值相等，即必"),i("br"),t._v("须全预留。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"限制(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{disabled:t.mem_limit_disabled,min:0,max:4096},model:{value:t.form.vmConfig.memory.limit,callback:function(e){t.$set(t.form.vmConfig.memory,"limit",e)},expression:"form.vmConfig.memory.limit"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: "+t._s(1024*t.form.vmConfig.memory.quantityMB)+"-"+t._s(1024*t.form.vmConfig.memory.quantityMB)+", 0表示不限")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.disk_arrow_icon,on:{click:t.showDiskInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"磁盘1","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:1024},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.disks[0].quantityGB,callback:function(e){t.$set(t.form.vmConfig.disks[0],"quantityGB",e)},expression:"form.vmConfig.disks[0].quantityGB"}}),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"}},[t._v("GB")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("如需指定系统盘，需要精确指定虚拟机设"),i("br"),t._v("备启动顺序，可以在选项->系统->启动方"),i("br"),t._v("式指定启动顺序。")]),i("i",{staticClass:"el-icon-warning",staticStyle:{color:"#66b1ff"}})])],1),i("el-collapse-transition",[t.show_disk?i("div",[i("el-form-item",{attrs:{label:"数据存储",prop:"dataStore","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{disabled:""},model:{value:t.form.vmConfig.disks[0].name,callback:function(e){t.$set(t.form.vmConfig.disks[0],"name",e)},expression:"form.vmConfig.disks[0].name"}}),i("el-button",{on:{click:t.handleSelectDataStore}},[t._v("选择")])],1),i("el-form-item",{attrs:{label:"配置模式","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"配置模式"},on:{change:t.handleSelectVolType},model:{value:t.form.vmConfig.disks[0].volType,callback:function(e){t.$set(t.form.vmConfig.disks[0],"volType",e)},expression:"form.vmConfig.disks[0].volType"}},t._l(t.config_mode_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),i("el-form-item",{attrs:{label:"总线类型","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"总线类型"},model:{value:t.form.vmConfig.disks[0].pciType,callback:function(e){t.$set(t.form.vmConfig.disks[0],"pciType",e)},expression:"form.vmConfig.disks[0].pciType"}},t._l(t.bus_type_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("VIRTIO/IDE/SCSI :创建虚拟机时，数据"),i("br"),t._v("存储上创建的磁盘可以挂载在VIRTIO、"),i("br"),t._v("IDE、SCSI总线上，VIRTIO性能较好，"),i("br"),t._v("IDE性能较差，仅用于虚拟机镜像制作及"),i("br"),t._v("虚拟机光驱。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.network_arrow_icon,on:{click:t.showNetworkInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"网卡1","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{disabled:""},model:{value:t.portGroupUrnTo,callback:function(e){t.portGroupUrnTo=e},expression:"portGroupUrnTo"}}),i("el-button",{on:{click:t.handleNetworkSwitch}},[t._v("选择")])],1),i("el-collapse-transition",[t.show_network?i("div",[i("el-form-item",{attrs:{label:"网卡类型","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"网卡类型"},model:{value:t.form.vmConfig.nics[0].virtIo,callback:function(e){t.$set(t.form.vmConfig.nics[0],"virtIo",e)},expression:"form.vmConfig.nics[0].virtIo"}},t._l(t.network_type_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("virtio : 高网络吞吐量和降低网络延迟的网"),i("br"),t._v("卡类型。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"IO环大小","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"IO环大小"},model:{value:t.form.vmConfig.nics[0].nicConfig.vringbuf,callback:function(e){t.$set(t.form.vmConfig.nics[0].nicConfig,"vringbuf",e)},expression:"form.vmConfig.nics[0].nicConfig.vringbuf"}},t._l(t.IO_ring_num_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("通过适当的调大IO环，可以缓解前端驱动"),i("br"),t._v("的丢包，提高性能。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"队列数","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"210px"},attrs:{min:1,max:t.form.vmConfig.cpu.quantity},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.nics[0].nicConfig.queues,callback:function(e){t.$set(t.form.vmConfig.nics[0].nicConfig,"queues",e)},expression:"form.vmConfig.nics[0].nicConfig.queues"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("队列数取值不能超过虚拟机当前的vCPU"),i("br"),t._v("数量。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"开启安全组","label-width":"135px"}},[i("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.handleSwitchSecurityGroup},model:{value:t.form.vmConfig.nics[0].enableSecurityGroup,callback:function(e){t.$set(t.form.vmConfig.nics[0],"enableSecurityGroup",e)},expression:"form.vmConfig.nics[0].enableSecurityGroup"}})],1),t.form.vmConfig.nics[0].enableSecurityGroup?i("el-form-item",{attrs:{label:"安全组","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},model:{value:t.form.vmConfig.nics[0].securityGroupId,callback:function(e){t.$set(t.form.vmConfig.nics[0],"securityGroupId",e)},expression:"form.vmConfig.nics[0].securityGroupId"}}),i("el-button",{on:{click:t.handleSelectSecurityGroup}},[t._v("选择")])],1):t._e()],1):t._e()])],1)],1)],1),i("el-tab-pane",{attrs:{label:"选项",name:"1"}},[i("el-row",[i("el-col",{attrs:{span:20}},[t._v("系统")]),i("el-col",{attrs:{span:4}},[i("el-button",{on:{click:t.handleRestoreDefault}},[t._v("恢复默认值")])],1)],1),i("el-divider",{staticClass:"horizontal"}),i("el-form-item",{attrs:{label:"时钟策略：","label-width":"135px"}},[i("el-checkbox",{model:{value:t.form.vmConfig.properties.clockMode,callback:function(e){t.$set(t.form.vmConfig.properties,"clockMode",e)},expression:"form.vmConfig.properties.clockMode"}},[t._v("与主机时钟同步")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("取消此选项，用户可自行设置虚拟机的时"),i("br"),t._v("间，站点下所有主机时间必须同步，否则"),i("br"),t._v("可能因主机时间不同步导致虚拟机HA、"),i("br"),t._v("迁移、休眠唤醒、快照恢复虚拟机后时间"),i("br"),t._v("发生跳变。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"启动引导固件：","label-width":"135px"}},[i("el-radio-group",{on:{change:t.handleSelectBootFirmware},model:{value:t.form.vmConfig.properties.bootFirmware,callback:function(e){t.$set(t.form.vmConfig.properties,"bootFirmware",e)},expression:"form.vmConfig.properties.bootFirmware"}},[i("el-radio",{attrs:{label:"BIOS"}},[t._v("BIOS")]),i("el-radio",{attrs:{label:"UEFI"}},[t._v("UEFI")])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("UEFI可扩展固件接口(Unified Extensible"),i("br"),t._v(" Firmware Interface)是传统BIOS的继任"),i("br"),t._v("者，兼容MBR和GPT分区格式从而支持"),i("br"),t._v("2T以上系统盘，但需要相应的操作系统支"),i("br"),t._v("持，支持的操作系统类型详情请查看联机"),i("br"),t._v("帮助。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"延迟时间(ms)：","label-width":"135px"}},[i("el-input",{staticClass:"create-input",staticStyle:{width:"200px"},attrs:{disabled:t.firmware_time_disabled},model:{value:t.form.vmConfig.properties.bootFirmwareTime,callback:function(e){t.$set(t.form.vmConfig.properties,"bootFirmwareTime",e)},expression:"form.vmConfig.properties.bootFirmwareTime"}})],1),i("el-form-item",{attrs:{label:"启动方式：","label-width":"135px"}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择启动方式"},model:{value:t.form.vmConfig.properties.bootOption,callback:function(e){t.$set(t.form.vmConfig.properties,"bootOption",e)},expression:"form.vmConfig.properties.bootOption"}},t._l(t.boot_mode_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),i("el-form-item",{attrs:{label:"VNC键盘配置：","label-width":"135px"}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择VNC键盘配置"},model:{value:t.form.vmConfig.properties.vmVncKeymapSetting,callback:function(e){t.$set(t.form.vmConfig.properties,"vmVncKeymapSetting",e)},expression:"form.vmConfig.properties.vmVncKeymapSetting"}},t._l(t.vnc_keyboard_options,(function(t){return i("el-option",{key:t.id,attrs:{label:t.vncKeymapDesCh,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"EVS亲和：","label-width":"135px"}},[i("el-checkbox",{model:{value:t.form.vmConfig.properties.evsAffinity,callback:function(e){t.$set(t.form.vmConfig.properties,"evsAffinity",e)},expression:"form.vmConfig.properties.evsAffinity"}},[t._v("开启")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("虚拟机EVS亲和开关开启、大页规格为1G"),i("br"),t._v("且运行主机已配置用户态EVS时亲和性策"),i("br"),t._v("略才生效，EVS亲和虚拟机CPU、内存与"),i("br"),t._v("EVS转发核在同一物理NUMA节点分配。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"安全虚拟机：","label-width":"135px"}},[i("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.handleSwitchSvm},model:{value:t.svm,callback:function(e){t.svm=e},expression:"svm"}})],1),t.svm?i("el-form-item",{attrs:{label:"安全类型：","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"请选择安全类型"},on:{change:t.handleSwitchSecureVm},model:{value:t.form.vmConfig.properties.safeType,callback:function(e){t.$set(t.form.vmConfig.properties,"safeType",e)},expression:"form.vmConfig.properties.safeType"}},t._l(t.security_type_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1):t._e(),t.svm?i("el-form-item",{attrs:{label:"安全虚拟机类型：","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"请选择安全虚拟机类型"},model:{value:t.secureVmTypeTo,callback:function(e){t.secureVmTypeTo=e},expression:"secureVmTypeTo"}},t._l(t.vm_security_type_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):t._e()],1)],1)],1):4===this.active?i("el-row",{staticClass:"row_lineheight"},[i("el-row",[i("el-col",{attrs:{span:10}},[i("div",[t._v("创建类型："+t._s(this.activeNameFormat(t.activeName)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("虚拟机名称："+t._s(t.form.name))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("描述："+t._s(t.form.describtion))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("所在位置："+t._s(t.parentObjUrnTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("计算资源："+t._s(t.locationTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("是否与主机绑定："+t._s(this.isBindingHostFormat(t.form.isBindingHost)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("操作系统类型："+t._s(t.form.osOptions.osType))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("操作系统版本号："+t._s(this.osVersionFormat(t.form.osOptions.osVersion)))])])],1),i("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("虚拟机配置")]),i("el-divider",{staticClass:"horizontal"}),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("CPU："+t._s(t.form.vmConfig.cpu.quantity)+"核")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("份额："+t._s(t.form.vmConfig.cpu.weight))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("预留(MHz)："+t._s(t.form.vmConfig.cpu.reservation))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("限制(MHz)："+t._s(t.form.vmConfig.cpu.limit))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("插槽数："+t._s(this.slotNumFormat(t.form.vmConfig.cpu.coresPerSocket)))])]),i("el-col",{attrs:{span:20}},[i("div",[t._v("每个插槽的内核数："+t._s(t.form.vmConfig.cpu.coresPerSocket))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("内存："+t._s(t.form.vmConfig.memory.quantityMB)+"GB")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("预留(MB)："+t._s(t.form.vmConfig.memory.reservation))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("限制(MB)："+t._s(t.form.vmConfig.memory.limit))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("份额："+t._s(t.form.vmConfig.memory.weight))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("磁盘1："+t._s(t.form.vmConfig.disks[0].quantityGB)+"GB")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("所属数据存储："+t._s(t.form.vmConfig.disks[0].name))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("配置模式："+t._s(t.form.vmConfig.disks[0].volType))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("总线类型："+t._s(t.form.vmConfig.disks[0].pciType))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("网卡1："+t._s(this.portGroupUrnTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("网卡类型："+t._s(t.form.vmConfig.nics[0].virtIo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("IO环大小："+t._s(t.form.vmConfig.nics[0].nicConfig.vringbuf))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("队列数："+t._s(t.form.vmConfig.nics[0].nicConfig.queues))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全组："+t._s(this.securityGroupFormat(t.form.vmConfig.nics[0].enableSecurityGroup)))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:t.showSystemInfo}},[t._v("选项 "+t._s(t.arrow))])])],1),i("el-collapse-transition",[t.show_system?i("div",[i("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("系统")]),i("el-divider",{staticClass:"horizontal"}),i("el-row",[i("el-col",{attrs:{span:10}},[i("div",[t._v("时钟策略："+t._s(this.clockModeFormat(t.form.vmConfig.properties.clockMode)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("EVS亲和："+t._s(this.evsAffinityFormat(t.form.vmConfig.properties.evsAffinity)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全类型："+t._s(this.safeTypeFormat(t.form.vmConfig.properties.safeType)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全虚拟机类型："+t._s(this.securiteTypeFormat(t.form.vmConfig.properties[t.form.vmConfig.properties.safeType])))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("启动引导固件："+t._s(t.form.vmConfig.properties.bootFirmware))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("延迟时间(ms)："+t._s(t.form.vmConfig.properties.bootFirmwareTime))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("VNC键盘配置："+t._s(this.keymapSettingFormat(t.form.vmConfig.properties.vmVncKeymapSetting)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("启动方式："+t._s(this.bootOptionFormat(t.form.vmConfig.properties.bootOption)))])])],1)],1):t._e()]),i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{labelWidth:"0"}},[i("el-checkbox",{on:{click:t.handleAutoBoot},model:{value:t.form.autoBoot,callback:function(e){t.$set(t.form,"autoBoot",e)},expression:"form.autoBoot"}},[t._v("创建完成后直接启动虚拟机")])],1)],1)],1)],1):t._e()],1):t._e(),"1"===this.activeName?i("el-row",[1===this.active?i("el-row",[i("el-form-item",{attrs:{label:"名称：",prop:"name","label-width":"150px"}},[i("el-input",{staticClass:"create-input",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"描述：",prop:"description","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{type:"textarea"},model:{value:t.form.descripttion,callback:function(e){t.$set(t.form,"descripttion",e)},expression:"form.descripttion"}})],1),i("el-form-item",{attrs:{label:"选择模板：",prop:"vmsTemplate","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{disabled:""},model:{value:t.form.vmsTemplate,callback:function(e){t.$set(t.form,"vmsTemplate",e)},expression:"form.vmsTemplate"}}),i("el-button",{on:{click:t.handleSelectTemplate}},[t._v("选择")])],1),i("el-form-item",{attrs:{label:"选择虚拟机位置：",prop:"parentObjUrn","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{disabled:""},model:{value:t.parentObjUrnTo,callback:function(e){t.parentObjUrnTo=e},expression:"parentObjUrnTo"}}),i("el-button",{on:{click:t.handleSelectPosition}},[t._v("选择")])],1),i("el-form-item",{attrs:{label:"选择计算资源：",prop:"location","label-width":"150px"}},[i("el-input",{staticClass:"create-input",attrs:{disabled:""},model:{value:t.locationTo,callback:function(e){t.locationTo=e},expression:"locationTo"}}),i("el-button",{on:{click:t.handleSelectCluster}},[t._v("选择")]),i("el-checkbox",{staticStyle:{"padding-left":"15px"},attrs:{disabled:t.checked_disabled},model:{value:t.form.isBindingHost,callback:function(e){t.$set(t.form,"isBindingHost",e)},expression:"form.isBindingHost"}},[t._v("与所选主机绑定")])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:11}},[i("el-form-item",{attrs:{label:"虚拟机数量：",labelWidth:"150px"}},[i("el-input-number",{staticStyle:{width:"130px"},attrs:{min:1,max:50},on:{change:t.handleAddVmSize},model:{value:t.form.vmSize,callback:function(e){t.$set(t.form,"vmSize",e)},expression:"form.vmSize"}})],1)],1),i("el-col",{attrs:{span:11}},[i("el-form-item",{attrs:{label:"名称后缀起始编号：",labelWidth:"150px"}},[i("el-input-number",{staticStyle:{width:"130px"},attrs:{disabled:t.postfix_index_disabled,min:0,max:99999},model:{value:t.form.namePostfixIndex,callback:function(e){t.$set(t.form,"namePostfixIndex",e)},expression:"form.namePostfixIndex"}})],1)],1)],1)],1):2===this.active?i("el-row",[i("el-tabs",{on:{"tab-click":t.handleVMClick},model:{value:t.activeVMName,callback:function(e){t.activeVMName=e},expression:"activeVMName"}},[i("el-tab-pane",{attrs:{label:"硬件",name:"0"}},[i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.cpu_arrow_icon,on:{click:t.showCPUInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"CPU","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:36},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.cpu.quantity,callback:function(e){t.$set(t.form.vmConfig.cpu,"quantity",e)},expression:"form.vmConfig.cpu.quantity"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 1-36"),i("br"),t._v("建议虚拟机的内核数是每个插槽的内核数"),i("br"),t._v("的整数倍。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-collapse-transition",[t.show_cpu?i("div",[i("el-form-item",{attrs:{label:"份额","label-width":"135px"}},[i("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"份额"},on:{change:t.handleCpuShare},model:{value:t.cpu_share,callback:function(e){t.cpu_share=e},expression:"cpu_share"}},t._l(t.cpu_share_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-input",{staticStyle:{width:"100px"},attrs:{disabled:t.cpu_share_disabled},model:{value:t.form.vmConfig.cpu.weight,callback:function(e){t.$set(t.form.vmConfig.cpu,"weight",e)},expression:"form.vmConfig.cpu.weight"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("描述：定义多个虚拟机在竞争物理CPU资"),i("br"),t._v("源时按比例分配，份额越高的虚拟机，竞"),i("br"),t._v("争物理CPU时获取的资源越多。 "),i("br"),t._v("范围："),i("br"),t._v(" 低：内核数*250"),i("br"),t._v(" 中：内核数*500"),i("br"),t._v(" 高：内核数*1000"),i("br"),t._v(" 自定义：2~255000")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"每个插槽内核数","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:36},model:{value:t.form.vmConfig.cpu.coresPerSocket,callback:function(e){t.$set(t.form.vmConfig.cpu,"coresPerSocket",e)},expression:"form.vmConfig.cpu.coresPerSocket"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 1-36"),i("br"),t._v("插槽数:"+t._s(Math.ceil(t.form.vmConfig.cpu.quantity/t.form.vmConfig.cpu.coresPerSocket)))]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"预留(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:4400},model:{value:t.form.vmConfig.cpu.reservation,callback:function(e){t.$set(t.form.vmConfig.cpu,"reservation",e)},expression:"form.vmConfig.cpu.reservation"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 0-"+t._s(2200*t.form.vmConfig.cpu.quantity)),i("br"),t._v(" 定义了多个虚拟机竞争物理CPU资源的时"),i("br"),t._v("候分配的最低计算资源。如果指定CPU的"),i("br"),t._v("预留值，需要排除故障和已经停止的主"),i("br"),t._v("机。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"限制(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:4400},model:{value:t.form.vmConfig.cpu.limit,callback:function(e){t.$set(t.form.vmConfig.cpu,"limit",e)},expression:"form.vmConfig.cpu.limit"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("0表示不限"),i("br"),t._v(" 控制虚拟机占用物理CPU资源的上限。以"),i("br"),t._v("一个两CPU的虚拟机为例，如果设置该虚"),i("br"),t._v("拟机CPU上限为3000MHz，则该虚拟机的"),i("br"),t._v("两个虚拟CPU计算能力被限制为"),i("br"),t._v("1500MHz。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.mem_arrow_icon,on:{click:t.showMemInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"内存","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:4096},on:{change:t.handleMemChange},model:{value:t.form.vmConfig.memory.quantityMB,callback:function(e){t.$set(t.form.vmConfig.memory,"quantityMB",e)},expression:"form.vmConfig.memory.quantityMB"}}),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"}},[t._v("GB")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("32位系统无法充分利用4G内存，建议32"),i("br"),t._v("位系统无需配满4G内存，可以配置"),i("br"),t._v("3583MB内存（约3.5GB）。")]),i("i",{staticClass:"el-icon-warning",staticStyle:{color:"#66b1ff"}})])],1),i("el-collapse-transition",[t.show_mem?i("div",[i("el-form-item",{attrs:{label:"份额","label-width":"135px"}},[i("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"份额"},on:{change:t.handleMemShare},model:{value:t.mem_share,callback:function(e){t.mem_share=e},expression:"mem_share"}},t._l(t.cpu_share_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-input",{staticClass:"create-input",staticStyle:{width:"100px"},attrs:{disabled:t.mem_share_disabled},model:{value:t.form.vmConfig.memory.weight,callback:function(e){t.$set(t.form.vmConfig.memory,"weight",e)},expression:"form.vmConfig.memory.weight"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("低：内存大小 * 5"),i("br"),t._v(" 中：内存大小 * 10"),i("br"),t._v(" 高：内存大小 * 20"),i("br"),t._v(" 自定义：1~83886080")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"预留(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{disabled:t.mem_reserve_disabled,min:0,max:4096},model:{value:t.form.vmConfig.memory.reservation,callback:function(e){t.$set(t.form.vmConfig.memory,"reservation",e)},expression:"form.vmConfig.memory.reservation"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: 0-"+t._s(1024*t.form.vmConfig.memory.quantityMB)),i("br"),t._v(" 当集群的内存复用开启时,内存预留值生"),i("br"),t._v("效;"),i("br"),t._v(" 具有PCI直通设备(包括SRIOV)的虚拟机"),i("br"),t._v("或是虚拟机所在主机配置了内存盘模式，"),i("br"),t._v("内存预留值必须和内存规格值相等，即必"),i("br"),t._v("须全预留。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"限制(MHz)","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{disabled:t.mem_limit_disabled,min:0,max:4096},model:{value:t.form.vmConfig.memory.limit,callback:function(e){t.$set(t.form.vmConfig.memory,"limit",e)},expression:"form.vmConfig.memory.limit"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("范围: "+t._s(1024*t.form.vmConfig.memory.quantityMB)+"-"+t._s(1024*t.form.vmConfig.memory.quantityMB)+", 0表示不限")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.disk_arrow_icon,on:{click:t.showDiskInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"磁盘1","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"200px"},attrs:{disabled:"",min:1,max:1024},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.disks[0].quantityGB,callback:function(e){t.$set(t.form.vmConfig.disks[0],"quantityGB",e)},expression:"form.vmConfig.disks[0].quantityGB"}}),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"}},[t._v("GB")])],1),i("el-collapse-transition",[t.show_disk?i("div",[i("el-form-item",{attrs:{label:"数据存储",prop:"dataStore","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{disabled:""},model:{value:t.form.vmConfig.disks[0].name,callback:function(e){t.$set(t.form.vmConfig.disks[0],"name",e)},expression:"form.vmConfig.disks[0].name"}}),i("el-button",{on:{click:t.handleSelectDataStore}},[t._v("选择")])],1),i("el-form-item",{attrs:{label:"配置模式","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"配置模式"},on:{change:t.handleSelectVolType},model:{value:t.form.vmConfig.disks[0].volType,callback:function(e){t.$set(t.form.vmConfig.disks[0],"volType",e)},expression:"form.vmConfig.disks[0].volType"}},t._l(t.config_mode_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),i("el-form-item",{attrs:{label:"总线类型","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"总线类型"},model:{value:t.form.vmConfig.disks[0].pciType,callback:function(e){t.$set(t.form.vmConfig.disks[0],"pciType",e)},expression:"form.vmConfig.disks[0].pciType"}},t._l(t.bus_type_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("VIRTIO/IDE/SCSI :创建虚拟机时，数据"),i("br"),t._v("存储上创建的磁盘可以挂载在VIRTIO、"),i("br"),t._v("IDE、SCSI总线上，VIRTIO性能较好，"),i("br"),t._v("IDE性能较差，仅用于虚拟机镜像制作及"),i("br"),t._v("虚拟机光驱。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1)],1):t._e()])],1)],1),i("el-row",[i("el-col",{staticClass:"mt10",attrs:{span:2}},[i("span",{class:t.network_arrow_icon,on:{click:t.showNetworkInfo}})]),i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"网卡1","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{disabled:""},model:{value:t.portGroupUrnTo,callback:function(e){t.portGroupUrnTo=e},expression:"portGroupUrnTo"}}),i("el-button",{on:{click:t.handleNetworkSwitch}},[t._v("选择")])],1),i("el-collapse-transition",[t.show_network?i("div",[i("el-form-item",{attrs:{label:"网卡类型","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"网卡类型"},model:{value:t.form.vmConfig.nics[0].virtIo,callback:function(e){t.$set(t.form.vmConfig.nics[0],"virtIo",e)},expression:"form.vmConfig.nics[0].virtIo"}},t._l(t.network_type_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("virtio : 高网络吞吐量和降低网络延迟的网"),i("br"),t._v("卡类型。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"IO环大小","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"IO环大小"},model:{value:t.form.vmConfig.nics[0].nicConfig.vringbuf,callback:function(e){t.$set(t.form.vmConfig.nics[0].nicConfig,"vringbuf",e)},expression:"form.vmConfig.nics[0].nicConfig.vringbuf"}},t._l(t.IO_ring_num_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("通过适当的调大IO环，可以缓解前端驱动"),i("br"),t._v("的丢包，提高性能。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"队列数","label-width":"135px"}},[i("el-input-number",{staticStyle:{width:"210px"},attrs:{min:1,max:t.form.vmConfig.cpu.quantity},on:{change:t.handleCPUChange},model:{value:t.form.vmConfig.nics[0].nicConfig.queues,callback:function(e){t.$set(t.form.vmConfig.nics[0].nicConfig,"queues",e)},expression:"form.vmConfig.nics[0].nicConfig.queues"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("队列数取值不能超过虚拟机当前的vCPU"),i("br"),t._v("数量。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"开启安全组","label-width":"135px"}},[i("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.handleSwitchSecurityGroup},model:{value:t.form.vmConfig.nics[0].enableSecurityGroup,callback:function(e){t.$set(t.form.vmConfig.nics[0],"enableSecurityGroup",e)},expression:"form.vmConfig.nics[0].enableSecurityGroup"}})],1),t.form.vmConfig.nics[0].enableSecurityGroup?i("el-form-item",{attrs:{label:"安全组","label-width":"135px"}},[i("el-input",{staticStyle:{width:"150px"},model:{value:t.form.vmConfig.nics[0].securityGroupId,callback:function(e){t.$set(t.form.vmConfig.nics[0],"securityGroupId",e)},expression:"form.vmConfig.nics[0].securityGroupId"}}),i("el-button",{on:{click:t.handleSelectSecurityGroup}},[t._v("选择")])],1):t._e()],1):t._e()])],1)],1)],1),i("el-tab-pane",{attrs:{label:"选项",name:"1"}},[i("el-row",[i("el-col",{attrs:{span:20}},[t._v("系统")]),i("el-col",{attrs:{span:4}},[i("el-button",{on:{click:t.handleRestoreDefault}},[t._v("恢复默认值")])],1)],1),i("el-divider",{staticClass:"horizontal"}),i("el-form-item",{attrs:{label:"时钟策略：","label-width":"135px"}},[i("el-checkbox",{model:{value:t.form.vmConfig.properties.clockMode,callback:function(e){t.$set(t.form.vmConfig.properties,"clockMode",e)},expression:"form.vmConfig.properties.clockMode"}},[t._v("与主机时钟同步")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("取消此选项，用户可自行设置虚拟机的时"),i("br"),t._v("间，站点下所有主机时间必须同步，否则"),i("br"),t._v("可能因主机时间不同步导致虚拟机HA、"),i("br"),t._v("迁移、休眠唤醒、快照恢复虚拟机后时间"),i("br"),t._v("发生跳变。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"启动引导固件：","label-width":"135px"}},[i("el-radio-group",{attrs:{disabled:""},on:{change:t.handleSelectBootFirmware},model:{value:t.form.vmConfig.properties.bootFirmware,callback:function(e){t.$set(t.form.vmConfig.properties,"bootFirmware",e)},expression:"form.vmConfig.properties.bootFirmware"}},[i("el-radio",{attrs:{label:"BIOS"}},[t._v("BIOS")]),i("el-radio",{attrs:{label:"UEFI"}},[t._v("UEFI")])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("UEFI可扩展固件接口(Unified Extensible"),i("br"),t._v(" Firmware Interface)是传统BIOS的继任"),i("br"),t._v("者，兼容MBR和GPT分区格式从而支持"),i("br"),t._v("2T以上系统盘，但需要相应的操作系统支"),i("br"),t._v("持，支持的操作系统类型详情请查看联机"),i("br"),t._v("帮助。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"延迟时间(ms)：","label-width":"135px"}},[i("el-input",{staticClass:"create-input",staticStyle:{width:"200px"},attrs:{disabled:t.firmware_time_disabled},model:{value:t.form.vmConfig.properties.bootFirmwareTime,callback:function(e){t.$set(t.form.vmConfig.properties,"bootFirmwareTime",e)},expression:"form.vmConfig.properties.bootFirmwareTime"}})],1),i("el-form-item",{attrs:{label:"启动方式：","label-width":"135px"}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择启动方式"},model:{value:t.form.vmConfig.properties.bootOption,callback:function(e){t.$set(t.form.vmConfig.properties,"bootOption",e)},expression:"form.vmConfig.properties.bootOption"}},t._l(t.boot_mode_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),i("el-form-item",{attrs:{label:"VNC键盘配置：","label-width":"135px"}},[i("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择VNC键盘配置"},model:{value:t.form.vmConfig.properties.vmVncKeymapSetting,callback:function(e){t.$set(t.form.vmConfig.properties,"vmVncKeymapSetting",e)},expression:"form.vmConfig.properties.vmVncKeymapSetting"}},t._l(t.vnc_keyboard_options,(function(t){return i("el-option",{key:t.id,attrs:{label:t.vncKeymapDesCh,value:t.id}})})),1)],1),i("el-form-item",{attrs:{label:"EVS亲和：","label-width":"135px"}},[i("el-checkbox",{model:{value:t.form.vmConfig.properties.evsAffinity,callback:function(e){t.$set(t.form.vmConfig.properties,"evsAffinity",e)},expression:"form.vmConfig.properties.evsAffinity"}},[t._v("开启")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("虚拟机EVS亲和开关开启、大页规格为1G"),i("br"),t._v("且运行主机已配置用户态EVS时亲和性策"),i("br"),t._v("略才生效，EVS亲和虚拟机CPU、内存与"),i("br"),t._v("EVS转发核在同一物理NUMA节点分配。")]),i("i",{staticClass:"el-icon-warning bluecolor"})])],1),i("el-form-item",{attrs:{label:"安全虚拟机：","label-width":"135px"}},[i("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.handleSwitchSvm},model:{value:t.svm,callback:function(e){t.svm=e},expression:"svm"}})],1),t.svm?i("el-form-item",{attrs:{label:"安全类型：","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"请选择安全类型"},on:{change:t.handleSwitchSecureVm},model:{value:t.form.vmConfig.properties.safeType,callback:function(e){t.$set(t.form.vmConfig.properties,"safeType",e)},expression:"form.vmConfig.properties.safeType"}},t._l(t.security_type_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1):t._e(),t.svm?i("el-form-item",{attrs:{label:"安全虚拟机类型：","label-width":"135px"}},[i("el-select",{attrs:{placeholder:"请选择安全虚拟机类型"},model:{value:t.secureVmTypeTo,callback:function(e){t.secureVmTypeTo=e},expression:"secureVmTypeTo"}},t._l(t.vm_security_type_options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):t._e()],1)],1)],1):3===this.active?i("el-row",[i("el-row",[i("el-col",{attrs:{span:10}},[i("div",[t._v("创建类型："+t._s(this.activeNameFormat(t.activeName)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("虚拟机名称："+t._s(t.form.name))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("描述："+t._s(t.form.describtion))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("所在位置："+t._s(t.parentObjUrnTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("计算资源："+t._s(t.locationTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("是否与主机绑定："+t._s(this.isBindingHostFormat(t.form.isBindingHost)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("操作系统类型："+t._s(t.form.osOptions.osType))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("操作系统版本号："+t._s(this.osVersionFormat(t.form.osOptions.osVersion)))])])],1),i("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("虚拟机配置")]),i("el-divider",{staticClass:"horizontal"}),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("CPU："+t._s(t.form.vmConfig.cpu.quantity)+"核")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("份额："+t._s(t.form.vmConfig.cpu.weight))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("预留(MHz)："+t._s(t.form.vmConfig.cpu.reservation))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("限制(MHz)："+t._s(t.form.vmConfig.cpu.limit))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("插槽数："+t._s(this.slotNumFormat(t.form.vmConfig.cpu.coresPerSocket)))])]),i("el-col",{attrs:{span:20}},[i("div",[t._v("每个插槽的内核数："+t._s(t.form.vmConfig.cpu.coresPerSocket))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("内存："+t._s(t.form.vmConfig.memory.quantityMB)+"GB")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("预留(MB)："+t._s(t.form.vmConfig.memory.reservation))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("限制(MB)："+t._s(t.form.vmConfig.memory.limit))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("份额："+t._s(t.form.vmConfig.memory.weight))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("磁盘1："+t._s(t.form.vmConfig.disks[0].quantityGB)+"GB")])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("所属数据存储："+t._s(t.form.vmConfig.disks[0].name))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("配置模式："+t._s(t.form.vmConfig.disks[0].volType))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("总线类型："+t._s(t.form.vmConfig.disks[0].pciType))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("div",[t._v("网卡1："+t._s(this.portGroupUrnTo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("网卡类型："+t._s(t.form.vmConfig.nics[0].virtIo))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("IO环大小："+t._s(t.form.vmConfig.nics[0].nicConfig.vringbuf))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("队列数："+t._s(t.form.vmConfig.nics[0].nicConfig.queues))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全组："+t._s(this.securityGroupFormat(t.form.vmConfig.nics[0].enableSecurityGroup)))])])],1),i("el-divider"),i("el-row",[i("el-col",{attrs:{span:20}},[i("span",{staticStyle:{color:"#409eff"},on:{click:t.showSystemInfo}},[t._v("选项 "+t._s(t.arrow))])])],1),i("el-collapse-transition",[t.show_system?i("div",[i("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("系统")]),i("el-divider",{staticClass:"horizontal"}),i("el-row",[i("el-col",{attrs:{span:10}},[i("div",[t._v("时钟策略："+t._s(this.clockModeFormat(t.form.vmConfig.properties.clockMode)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("EVS亲和："+t._s(this.evsAffinityFormat(t.form.vmConfig.properties.evsAffinity)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全类型："+t._s(this.safeTypeFormat(t.form.vmConfig.properties.safeType)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("安全虚拟机类型："+t._s(this.securiteTypeFormat(t.form.vmConfig.properties[t.form.vmConfig.properties.safeType])))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("启动引导固件："+t._s(t.form.vmConfig.properties.bootFirmware))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("延迟时间(ms)："+t._s(t.form.vmConfig.properties.bootFirmwareTime))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("VNC键盘配置："+t._s(this.keymapSettingFormat(t.form.vmConfig.properties.vmVncKeymapSetting)))])]),i("el-col",{attrs:{span:10}},[i("div",[t._v("启动方式："+t._s(this.bootOptionFormat(t.form.vmConfig.properties.bootOption)))])])],1)],1):t._e()]),i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{labelWidth:"0"}},[i("el-checkbox",{on:{click:t.handleAutoBoot},model:{value:t.form.autoBoot,callback:function(e){t.$set(t.form,"autoBoot",e)},expression:"form.autoBoot"}},[t._v("创建完成后直接启动虚拟机")])],1)],1)],1)],1):t._e()],1):t._e()],1)],1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{disabled:t.prev_disabled},on:{click:t.prevStep}},[t._v("上一步")]),i("el-button",{attrs:{type:"primary"},on:{click:t.nextStep}},[t._v(t._s(t.next_step))])],1)]),i("el-dialog",{attrs:{title:"选择虚拟机位置",visible:t.positionVisible,width:"38%"},on:{"update:visible":function(e){t.positionVisible=e}}},[i("div",{staticClass:"selecct-dialog-div"},[i("el-tree",{attrs:{data:t.position_data,"highlight-current":"","expand-on-click-node":!1,props:t.defaultProps},on:{"node-click":t.handlePositionClick},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.node;return i("span",{staticClass:"custom-tree-node"},[i("span",[i("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"font-size":"10px"}}),t._v(" "+t._s(o.label)+" ")])])}}])})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelPosition}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addPosition}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"选择计算资源",visible:t.clusterVisible,width:"38%"},on:{"update:visible":function(e){t.clusterVisible=e}}},[i("div",{staticClass:"select-dialog-div"},[i("el-tree",{attrs:{load:t.loadNode,"expand-on-click-node":!1,"default-expand-all":"","highlight-current":"",props:t.defaultProps,lazy:""},on:{"node-click":t.handleClusterClick}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelCluster}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addCluster}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"选择模板",visible:t.templateVisible,width:"65%"},on:{"update:visible":function(e){t.templateVisible=e}}},[i("div",{staticClass:"vm-dialog-div"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.templateTableData,border:"","highlight-current-row":"","max-height":"600"},on:{"current-change":t.handleTemplateChange}},[i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),i("el-table-column",{attrs:{prop:"uri",formatter:t.uriFormat,label:"ID",align:"center"}}),i("el-table-column",{attrs:{prop:"status",formatter:t.statusFormat,label:"状态",align:"center"}}),i("el-table-column",{attrs:{prop:"clusterName",label:"所在集群",align:"center"}}),i("el-table-column",{attrs:{prop:"hostName",label:"所在主机",align:"center"}}),i("el-table-column",{attrs:{prop:"isBindingHost",formatter:t.isBindingFormat,label:"与主机绑定",align:"center"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelTemplate}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addTemplate}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"选择数据存储",visible:t.dataStoreVisible,width:"65%"},on:{"update:visible":function(e){t.dataStoreVisible=e}}},[i("div",{staticClass:"vm-dialog-div"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.storeTableData,border:"","highlight-current-row":"","max-height":"600"},on:{"current-change":t.handleDataStoreChange}},[i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),i("el-table-column",{attrs:{prop:"actualFreeSizeGB",label:"可用容量(GB)",align:"center"}}),i("el-table-column",{attrs:{prop:"usedSizeGB",label:"已分配容量(GB)",align:"center"}}),i("el-table-column",{attrs:{prop:"capacityGB",label:"总容量(GB)",align:"center"}}),i("el-table-column",{attrs:{prop:"isThin",formatter:t.storageisThinFormat,label:"精简配置",align:"center"}}),i("el-table-column",{attrs:{prop:"storageType",formatter:t.storageTypeFormat,label:"类型",align:"center"}}),i("el-table-column",{attrs:{prop:"dsLockType",formatter:t.storageLockTypeFormat,label:"锁类型",align:"center"}}),i("el-table-column",{attrs:{prop:"refreshTime",label:"上次更新时间",align:"center"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelDataStore}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addDataStore}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"选择端口组",visible:t.networkSwitchVisible,width:"55%"},on:{"update:visible":function(e){t.networkSwitchVisible=e}}},[i("div",{staticClass:"select-dialog-div"},[i("span",[t._v("分布式交换机：")]),i("el-select",{attrs:{placeholder:"请选择分布式交换机"},on:{change:t.handleSetPortGroupNum},model:{value:t.form.dv_switch,callback:function(e){t.$set(t.form,"dv_switch",e)},expression:"form.dv_switch"}},t._l(t.dv_switch_options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.portGroupTableData,border:"","highlight-current-row":"","max-height":"600"},on:{"current-change":t.handlePortGroupChange}},[i("el-table-column",{attrs:{prop:"name",label:"端口组名称",align:"center"}}),i("el-table-column",{attrs:{prop:"portType",formatter:t.portTypeFormat,label:"端口类型",align:"center"}}),i("el-table-column",{attrs:{prop:"vlanId",label:"VLAN",align:"center"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelPortGroup}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addPortGroup}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"选择安全组",visible:t.securityGroupVisible,width:"45%"},on:{"update:visible":function(e){t.securityGroupVisible=e}}},[i("div",{staticClass:"vm-dialog-div"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.securityGroupTableData,border:"","highlight-current-row":"","max-height":"600"},on:{"current-change":t.handleSecurityGroupChange}},[i("el-table-column",{attrs:{prop:"sgName",label:"名称",align:"center"}}),i("el-table-column",{attrs:{prop:"sgId",label:"安全组ID",align:"center"}}),i("el-table-column",{attrs:{prop:"rules",label:"规则数量",align:"center"}}),i("el-table-column",{attrs:{prop:"description",label:"描述",align:"center"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelSecurityGroup}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.addSecurityGroup}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"提示",visible:t.deleteVisible,width:"25%"},on:{"update:visible":function(e){t.deleteVisible=e}}},[i("span",[t._v("确定要删除虚拟机 "+t._s(t.vms_name)+" 吗？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.deleteVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.deleteVms}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"提示",visible:t.stopVisible,width:"25%"},on:{"update:visible":function(e){t.stopVisible=e}}},[i("span",[t._v("确定要停止虚拟机 "+t._s(t.vms_name)+" 吗？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.stopVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.stopVms}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"提示",visible:t.startVisible,width:"25%"},on:{"update:visible":function(e){t.startVisible=e}}},[i("span",[t._v("确定要运行虚拟机 "+t._s(t.vms_name)+" 吗？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.startVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.startVms}},[t._v("确 定")])],1)])],1)},s=[],a=(i("a4d3"),i("e01a"),i("99af"),i("d81d"),i("b0c0"),i("ac1f"),i("1276"),{data:function(){return{options:[],step_options:[{value:"选项1",label:"选择创建类型"},{value:"选项2",label:"基本配置"},{value:"选项3",label:"选择数据存储"},{value:"选项4",label:"虚拟机配置"},{value:"选项5",label:"确认信息"}],os_type_arr:[{id:1,label:"Windows"},{id:2,label:"Linux"},{id:3,label:"其他"}],position_data:[],cluster_data:[],host_data:[],defaultProps:{children:"children",label:"label"},huaweiyun_options:[],os_version_options:[],gpu_options:["VGA"],floppy_drive_options:["自动匹配"],gpu_size_options:[],security_type_options:[],vm_security_type_options:[],cpu_band_category_options:[],cpu_share_options:[],large_page_config_options:[],config_mode_options:[],disk_mode_options:[],bus_type_options:[],network_type_options:[],IO_ring_num_options:[],dv_switch_options:[],boot_mode_options:[],vnc_keyboard_options:[],query:{address:"",name:"",pageIndex:1,pageSize:10},keywords:"",tableData:[],storeTableData:[],templateTableData:[],portGroupTableData:[],securityGroupTableData:[],multipleSelection:[],delList:[],title:"",editVisible:!1,deleteVisible:!1,stopVisible:!1,startVisible:!1,positionVisible:!1,templateVisible:!1,clusterVisible:!1,dataStoreVisible:!1,networkSwitchVisible:!1,securityGroupVisible:!1,datetimeFormat:null,pageTotal:0,huaweiyun_env:"",huaweiyun_env_info:"",select_vm_position:"",select_vm_cluster:"",select_vm_cluster_to:"",currentSelectDataStore:"",currentSelectPortGroup:"",currentSelectSecurityGroup:"",currentSelectDataStoreUrn:"",currentSelectTemplate:"",show_system:!1,show_cpu:!1,show_mem:!1,show_network:!1,show_disk:!1,prev_disabled:!0,checked_disabled:!0,cpu_disabled:!0,cpu_share_disabled:!0,mem_share_disabled:!0,mem_reserve_disabled:!1,mem_limit_disabled:!1,firmware_time_disabled:!1,postfix_index_disabled:!0,svm:!1,next_step:"下一步",arrow:">>",cpu_arrow_icon:"el-icon-caret-right",mem_arrow_icon:"el-icon-caret-right",disk_arrow_icon:"el-icon-caret-right",network_arrow_icon:"el-icon-caret-right",select_level:0,form:{name:"",description:"",parentObjUrn:"",location:"",osOptions:{osType:"Windows",osVersion:""},vmConfig:{cpu:{weight:1e3,reservation:0,quantity:2,limit:0,coresPerSocket:1},memory:{quantityMB:4,reservation:0,weight:40960,limit:0},disks:[{datastoreUrn:"",name:"autoDS_CNA001",quantityGB:40,sequenceNum:1,isThin:!1,pciType:"VIRTIO",volType:1}],nics:[{sequenceNum:0,portGroupUrn:"",virtIo:1,nicConfig:{vringbuf:256,queues:1},enableSecurityGroup:!1}],properties:{clockMode:!1,bootFirmware:"BIOS",evsAffinity:!1,bootFirmwareTime:0,bootOption:"disk",vmVncKeymapSetting:7,isAutoAdjustNuma:!1}},isBindingHost:!1,autoBoot:!0},idx:-1,id:-1,activeName:"0",activeVMName:"0",active:0,showOption:!1,locationTo:"",parentObjUrnTo:"",portGroupUrnTo:"",secureVmTypeTo:"GVM",vms_name:"",cpu_share:"中",mem_share:"中",template_id:"",loading:!0,rules:{name:[{required:!0,message:"请输入虚拟机名称"}],parentObjUrn:[{required:!0,message:"请选择虚拟机位置",trigger:"blur"}],location:[{required:!0,message:"请选择计算资源",trigger:"change"}],vmsTemplate:[{required:!0,message:"请选择虚拟机模板",trigger:"change"}]}}},created:function(){this.token=localStorage.getItem("token"),this.username=localStorage.getItem("username"),this.getHuaweiyunData()},methods:{activeNameFormat:function(t){return"0"===t?"创建新虚拟机":"1"===t?"使用模板部署虚拟机":void 0},slotNumFormat:function(t){return 1===t?this.form.vmConfig.cpu.quantity:Math.ceil(this.form.vmConfig.cpu.quantity/t)},isBindingFormat:function(t){return!1===t.isBindingHost?"否":"是"},uriFormat:function(t){return t.uri.split("/")[5]},isBindingHostFormat:function(t){return!1===t?"不绑定":"绑定"},osVersionFormat:function(t){for(var e=0;e<this.os_version_options.length;e++)if(this.os_version_options[e].os_id===t)return this.os_version_options[e].os_version},securityGroupFormat:function(t){return!1===t?"未开启":this.form.vmConfig.nics[0].securityGroupId},evsAffinityFormat:function(t){return!1===t?"未开启":"开启"},clockModeFormat:function(t){return!1===t?"自由时钟":"同步时钟"},keymapSettingFormat:function(t){return 7===t?"英语（美国）":12===t?"法语":4===t?"德语":19===t?"意大利语":30===t?"俄语":8===t?"西班牙语":void 0},bootOptionFormat:function(t){return"disk"===t?"硬盘启动":"cdrom"===t?"光驱启动":"pxe"===t?"网络启动":void 0},safeTypeFormat:function(t){return!1===this.svm?"未开启":"secureVmType"===t?"防病毒":"dpiVmType"===t?"DPI":void 0},securiteTypeFormat:function(){return!1===this.svm?"未开启":this.secureVmTypeTo},statusFormat:function(t){return"stopped"===t.status?"已停止":"running"===t.status?"运行中":"unknown"===t.status?"不明确":"hibernated"===t.status?"已休眠":"creating"===t.status?"创建中或模板正在部署虚拟机或正在导入模板":"shutting-down"===t.status?"删除中":"migrating"===t.status?"迁移中":"fault-resuming"===t.status?"故障恢复中":"starting"===t.status?"启动中":"stopping"===t.status?"停止中":"hibernating"===t.status?"休眠中":"pause"===t.status?"已暂停":"recycling"===t.status?"回收中":void 0},typeFormat:function(t){return 0===t.vmType?"普通虚拟机":1===t.vmType?"容灾虚拟机":2===t.vmType?"占位虚拟机":void 0},storageisThinFormat:function(t){return!0===t.isThin?"支持":"不支持"},storageLockTypeFormat:function(t){return 0===t.dsLockType?"-":1===t.dsLockType?"分布式锁":2===t.dsLockType?"硬件辅助锁":void 0},portTypeFormat:function(t){return 0===t.portType?"Access":1===t.portType?"Trunk":void 0},storageTypeFormat:function(t){return"LOCALPOME"===t.storageType?"虚拟化的本地存储":"local"===t.storageType?"本地存储":"san"===t.storageType?"共享存储(大lun)":"advanceSan"===t.storageType?"共享存储(小lun)":"DSWARE"===t.storageType?"华为分布式存储系统":"NAS"===t.storageType?"NAS存储":"LUNPOME"===t.storageType?"虚拟化的共享存储(大LUN)":"LUN"===t.storageType?"裸设备映射的共享存储":"iotailor"===t.storageType?"本地内存盘":void 0},getHuaweiyunData:function(){var t=this;this.$http.get("automation/api/huawei/",{headers:{token:this.token}}).then((function(e){sessionStorage.getItem("huaweiyun_env")?t.huaweiyun_env=JSON.parse(sessionStorage.getItem("huaweiyun_env")).hw_ip:(sessionStorage.setItem("huaweiyun_env",JSON.stringify(e.data[0])),t.huaweiyun_env=e.data[0].hw_ip),t.huaweiyun_options=e.data,t.getData()})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))},getData:function(){var t=this,e=this.keywords,i=this.url;i=e?"automation/api/huawei/vms/?Template=false&name=".concat(e):"automation/api/huawei/vms/?Template=false",this.$http.get("".concat(i),{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){e.data.vms.map((function(t){t["id"]=t["uri"].split("/")[5],t["ip"]=t["vmConfig"].nics[0].ip})),t.tableData=e.data.vms,t.pageTotal=e.data.total,t.loading=!1})).catch((function(e){console.log(e),t.$message.error("查询失败！"),t.loading=!1}))},handleSelectHuaweiEnv:function(t){this.tableData=[],this.handleSetHuaweiEnvInfo(t),sessionStorage.setItem("huaweiyun_env",JSON.stringify(this.huaweiyun_env_info)),this.getData()},handleSetHuaweiEnvInfo:function(t){for(var e=0,i=this.huaweiyun_options.length;e<i;e++)if(this.huaweiyun_options[e].hw_ip===t)return this.huaweiyun_env_info=this.huaweiyun_options[e]},handleSearch:function(){this.$set(this.query,"pageIndex",1),this.getData()},handleDeleteVms:function(t,e){this.id=e.id,this.vms_name=e.name,this.deleteVisible=!0},deleteVms:function(){var t=this;this.$http.delete("automation/api/huawei/delete_vms/?id=".concat(this.id,"&isFormat=0&holdTime=0"),{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){200===e.status||204===e.status?(t.$message.success("删除成功！"),t.deleteVisible=!1,t.getData()):(t.$message.error("删除失败！"),t.deleteVisible=!1)})).catch((function(e){t.$message.error(JSON.stringify(e.response.data)),t.deleteVisible=!1}))},handleSelectionChange:function(t){this.currentSelectDataStore=t.name,this.currentSelectDataStoreUrn=t.urn},delAllSelection:function(){var t=this.multipleSelection.length,e="";this.delList=this.delList.concat(this.multipleSelection);for(var i=0;i<t;i++)e+=this.multipleSelection[i].name+" ";this.$message.error("删除了".concat(e)),this.multipleSelection=[]},handleStepOPtions:function(t){this.locationTo="",this.form={name:"New Virtual Machine",description:"",parentObjUrn:"",vmsTemplate:"",location:"",osOptions:{osType:"Windows",osVersion:""},vmConfig:{cpu:{weight:1e3,reservation:0,quantity:2,limit:0,coresPerSocket:1},memory:{quantityMB:4,reservation:0,weight:40960,limit:0},disks:[{datastoreUrn:"",name:"autoDS_CNA001",quantityGB:40,sequenceNum:1,isThin:!1,pciType:"VIRTIO",volType:1}],nics:[{sequenceNum:0,portGroupUrn:"",virtIo:1,nicConfig:{vringbuf:256,queues:1},enableSecurityGroup:!1}],properties:{clockMode:!1,bootFirmware:"BIOS",evsAffinity:!1,bootFirmwareTime:0,bootOption:"disk",vmVncKeymapSetting:7,isAutoAdjustNuma:!1,safeType:"secureVmType"}},isBindingHost:!1,autoBoot:!0,vmSize:1,namePostfixIndex:0},this.show_cpu=!1,this.cpu_arrow_icon="el-icon-caret-right",this.show_mem=!1,this.mem_arrow_icon="el-icon-caret-right",this.show_network=!1,this.network_arrow_icon="el-icon-caret-right",this.show_disk=!1,this.disk_arrow_icon="el-icon-caret-right",this.cpu_share="中",this.mem_share="中",this.selectOsType(),"0"===t.name?(this.step_options=[{value:"选项1",label:"选择创建类型"},{value:"选项2",label:"基本配置"},{value:"选项3",label:"选择数据存储"},{value:"选项4",label:"虚拟机配置"},{value:"选项5",label:"确认信息"}],this.showOption=!0):"1"===t.name&&(this.step_options=[{value:"选项1",label:"选择创建类型"},{value:"选项2",label:"基本配置"},{value:"选项3",label:"虚拟机配置"},{value:"选项4",label:"确认信息"}])},selectVmPosition:function(){var t=this;this.$http.get("automation/api/huawei/sites/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.position_data=e.data.sites})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))},handleSelectPosition:function(){this.selectVmPosition(),this.positionVisible=!0},handlePositionClick:function(t){this.select_vm_position=t.urn},addPosition:function(){this.form.parentObjUrn=this.select_vm_position,this.positionVisible=!1},cancelPosition:function(){this.positionVisible=!1},handleSelectCluster:function(){this.clusterVisible=!0},loadNode:function(t,e){var i=this;if(0===t.level?this.$http.get("automation/api/huawei/sites/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(t){return i.position_data=t.data.sites,e(i.position_data)})).catch((function(t){i.$message.error(JSON.stringify(t.response.data))})):1===t.level?this.$http.get("automation/api/huawei/clusters/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(t){return i.cluster_data=t.data.clusters,e(i.cluster_data)})).catch((function(t){i.$message.error(JSON.stringify(t.response.data))})):2===t.level&&this.$http.get("automation/api/huawei/hosts?scope=".concat(t.data.urn),{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(t){return i.host_data=t.data.hosts,e(i.host_data)})).catch((function(t){i.$message.error(JSON.stringify(t.response.data))})),t.level>2)return e([])},handleClusterClick:function(t,e){2===e.level&&0===e.childNodes.length?(this.select_level=4,this.$alert("该节点下没有可用主机，请重新选择","提示",{confirmButtonText:"确定"}).catch((function(t){return t}))):null==e.parent.parent?(this.select_level=4,this.$alert("该节点不能作为计算资源被选择，请重新选择","提示",{confirmButtonText:"确定"}).catch((function(t){return t}))):(this.select_vm_cluster=t.urn,this.select_vm_cluster_to=t.label,this.select_level=e.level)},addCluster:function(){this.locationTo=this.select_vm_cluster_to,this.form.location=this.select_vm_cluster,3===this.select_level?(this.checked_disabled=!1,this.clusterVisible=!1):4===this.select_level?this.$alert("请选择集群和主机。","提示",{confirmButtonText:"确定"}).catch((function(t){return t})):(this.checked_disabled=!0,this.clusterVisible=!1)},cancelCluster:function(){this.clusterVisible=!1},getDatastore:function(){var t=this;this.$http.get("automation/api/huawei/datastores/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.storeTableData=e.data.datastores})).catch((function(e){console.log(e),t.$message.error("查询失败！")}))},handleSelectDataStore:function(){this.dataStoreVisible=!0},handleDataStoreChange:function(t){this.currentSelectDataStore=t.name,this.currentSelectDataStoreUrn=t.urn},cancelDataStore:function(){this.dataStoreVisible=!1},addDataStore:function(){this.form.vmConfig.disks[0].name=this.currentSelectDataStore,this.form.vmConfig.disks[0].datastoreUrn=this.currentSelectDataStoreUrn,this.dataStoreVisible=!1},getDVSwitchData:function(){var t=this;this.$http.get("automation/api/huawei/dvswitch/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){var i=e.data.dvSwitchs,o=[];i.map((function(t){o.push({label:t.name,value:t.portGroupNum})})),t.dv_switch_options=o,t.form.dv_switch=i[0].name,t.getPortGroupData(i[0].portGroupNum)})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))},getPortGroupData:function(t){var e=this;this.$http.get("automation/api/huawei/portgroups?portGroupNum=".concat(t),{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(t){e.portGroupTableData=t.data.portGroups})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},handleNetworkSwitch:function(){this.getDVSwitchData(),this.networkSwitchVisible=!0},handleSetPortGroupNum:function(t){this.getPortGroupData(t)},handlePortGroupChange:function(t){this.currentSelectPortGroup=t.urn},cancelPortGroup:function(){this.networkSwitchVisible=!1},addPortGroup:function(){this.form.vmConfig.nics[0].portGroupUrn=this.currentSelectPortGroup,this.networkSwitchVisible=!1},getSecurityGroupData:function(){var t=this;this.$http.get("automation/api/huawei/securitygroups",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.securityGroupTableData=e.data.securityGroups})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))},handleSelectSecurityGroup:function(){this.getSecurityGroupData(),this.securityGroupVisible=!0},handleSecurityGroupChange:function(t){this.currentSelectSecurityGroup=t.sgId},cancelSecurityGroup:function(){this.securityGroupVisible=!1},addSecurityGroup:function(){this.form.vmConfig.nics[0].securityGroupId=this.currentSelectSecurityGroup,this.securityGroupVisible=!1},handleSelectGpuSize:function(){"Cirrus"===this.form.gpu?this.gpu_size_options=[4]:"VGA"===this.form.gpu&&(this.gpu_size_options=[4,8,16,32,64,128,256])},selectVmsTemplate:function(){var t=this;this.$http.get("automation/api/huawei/vms/?Template=true",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.templateTableData=e.data.vms})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))},handleSelectTemplate:function(){this.selectVmsTemplate(),this.templateVisible=!0},handleTemplateChange:function(t){this.currentSelectTemplate=t},addTemplate:function(){this.currentSelectTemplate?(this.form.vmsTemplate=this.currentSelectTemplate.name,this.locationTo=this.currentSelectTemplate.locationName,this.form.name=this.currentSelectTemplate.name,this.form.location=this.currentSelectTemplate.location,this.form.vmConfig.cpu=this.currentSelectTemplate.vmConfig.cpu,this.form.vmConfig.memory=this.currentSelectTemplate.vmConfig.memory,this.form.vmConfig.disks[0].datastoreUrn=this.currentSelectTemplate.vmConfig.disks[0].datastoreUrn,this.form.vmConfig.disks[0].name=this.currentSelectTemplate.vmConfig.disks[0].name,this.form.vmConfig.disks[0].quantityGB=this.currentSelectTemplate.vmConfig.disks[0].quantityGB,this.form.vmConfig.disks[0].sequenceNum=this.currentSelectTemplate.vmConfig.disks[0].sequenceNum,this.form.vmConfig.disks[0].indepDisk=this.currentSelectTemplate.vmConfig.disks[0].indepDisk,this.form.vmConfig.disks[0].persistentDisk=this.currentSelectTemplate.vmConfig.disks[0].persistentDisk,this.form.vmConfig.disks[0].systemVolume=this.currentSelectTemplate.vmConfig.disks[0].systemVolume,this.form.vmConfig.disks[0].isThin=this.currentSelectTemplate.vmConfig.disks[0].isThin,this.form.vmConfig.disks[0].pciType=this.currentSelectTemplate.vmConfig.disks[0].pciType,this.form.vmConfig.disks[0].volType=this.currentSelectTemplate.vmConfig.disks[0].volType,this.form.vmConfig.nics[0].sequenceNum=this.currentSelectTemplate.vmConfig.nics[0].sequenceNum,this.form.vmConfig.nics[0].portGroupUrn=this.currentSelectTemplate.vmConfig.nics[0].portGroupUrn,this.form.vmConfig.nics[0].virtIo=this.currentSelectTemplate.vmConfig.nics[0].virtIo,this.form.vmConfig.nics[0].nicConfig=this.currentSelectTemplate.vmConfig.nics[0].nicConfig,this.form.vmConfig.nics[0].enableSecurityGroup=this.currentSelectTemplate.vmConfig.nics[0].enableSecurityGroup,this.form.vmConfig.properties.clockMode=this.currentSelectTemplate.vmConfig.properties.clockMode,this.form.vmConfig.properties.bootFirmware=this.currentSelectTemplate.vmConfig.properties.bootFirmware,this.form.vmConfig.properties.bootFirmwareTime=this.currentSelectTemplate.vmConfig.properties.bootFirmwareTime,this.form.vmConfig.properties.bootOption=this.currentSelectTemplate.vmConfig.properties.bootOption,this.form.vmConfig.properties.evsAffinity=this.currentSelectTemplate.vmConfig.properties.evsAffinity,this.form.vmConfig.properties.vmVncKeymapSetting=this.currentSelectTemplate.vmConfig.properties.vmVncKeymapSetting,this.form.vmConfig.properties.isAutoUpgrade=this.currentSelectTemplate.vmConfig.properties.isAutoUpgrade,this.form.vmConfig.properties.attachType=this.currentSelectTemplate.vmConfig.properties.attachType,this.form.vmConfig.properties.isEnableMemVol=this.currentSelectTemplate.vmConfig.properties.isEnableMemVol,this.form.vmConfig.properties.isEnableFt=this.currentSelectTemplate.vmConfig.properties.isEnableFt,this.form.vmConfig.properties.isAutoAdjustNuma=this.currentSelectTemplate.vmConfig.properties.isAutoAdjustNuma,this.form.vmConfig.properties.secureVmType=this.currentSelectTemplate.vmConfig.properties.secureVmType,this.form.vmConfig.properties.dpiVmType=this.currentSelectTemplate.vmConfig.properties.dpiVmType,this.form.osOptions=this.currentSelectTemplate.osOptions,this.form.isBindingHost=this.currentSelectTemplate.isBindingHost,this.form.description=this.currentSelectTemplate.description,this.form.autoBoot=!1,this.template_id=this.currentSelectTemplate.uri.split("/")[5],this.selectOsType(),this.templateVisible=!1):this.$message.warning("请选择一个模板！")},cancelTemplate:function(){this.templateVisible=!1},prevStep:function(){this.active--,0===this.active?this.prev_disabled=!0:this.prev_disabled=!1,this.next_step="下一步"},nextStep:function(){var t=this;"下一步"===this.next_step?(this.active++,this.prev_disabled=!1,"0"===this.activeName&&1===this.active?this.$http.get("automation/api/huawei/sites/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.position_data=e.data.sites,t.form.parentObjUrn=t.position_data[0].urn,t.parentObjUrnTo=t.position_data[0].label})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))})):"0"===this.activeName&&2===this.active?this.$refs.form.validate((function(e){e?t.$http.get("automation/api/huawei/datastores/",{headers:{token:t.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.storeTableData=e.data.datastores,t.$refs.singleTable.setCurrentRow(t.storeTableData[0])})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))})):(t.active--,t.$message.warning("请选择必填项"))})):"0"===this.activeName&&3===this.active?(this.form.vmConfig.disks[0].name=this.currentSelectDataStore,this.form.vmConfig.disks[0].datastoreUrn=this.currentSelectDataStoreUrn,this.$http.get("automation/api/huawei/dvswitch/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){var i=e.data.dvSwitchs,o=[];i.map((function(t){o.push({label:t.name,value:t.portGroupNum})})),t.dv_switch_options=o,t.form.dv_switch=i[0].name,t.$http.get("automation/api/huawei/portgroups?portGroupNum=".concat(i[0].portGroupNum,"/"),{headers:{token:t.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.portGroupTableData=e.data.portGroups,t.form.vmConfig.nics[0].portGroupUrn=t.portGroupTableData[0].urn,t.portGroupUrnTo=t.portGroupTableData[0].name})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))}))):"0"===this.activeName&&4===this.active?(console.log(this.form.vmConfig.properties.clockMode),this.next_step="确认"):"1"===this.activeName&&1===this.active?this.$http.get("automation/api/huawei/sites/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.position_data=e.data.sites,t.form.parentObjUrn=t.position_data[0].urn,t.parentObjUrnTo=t.position_data[0].label})).catch((function(e){t.$message.error(JSON.stringify(e.response.data))})):"1"===this.activeName&&2===this.active?this.$refs.form.validate((function(e){e?(t.form.vmConfig.memory.quantityMB=t.currentSelectTemplate.vmConfig.memory.quantityMB/1024,t.form.vmConfig.disks[0].name=t.currentSelectTemplate.vmConfig.disks[0].datastoreName,t.portGroupUrnTo=t.currentSelectTemplate.vmConfig.nics[0].portGroupName):(t.active--,t.$message.warning("请选择必填项"))})):"1"===this.activeName&&3===this.active&&(this.next_step="确认")):"0"===this.activeName&&"确认"===this.next_step?(!1===this.form.vmConfig.properties.clockMode?this.form.vmConfig.properties.clockMode="freeClock":this.form.vmConfig.properties.clockMode="synchClock",!1===this.svm&&(delete this.form.vmConfig.properties.safeType,delete this.form.vmConfig.properties.secureVmType,delete this.form.vmConfig.properties.dpiVmType),this.form.vmConfig.memory.quantityMB=1024*this.form.vmConfig.memory.quantityMB,this.$http.post("automation/api/huawei/create_vms/",this.form,{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){200===e.status||201===e.status?(t.$message.success("创建成功！"),t.editVisible=!1,t.getData()):t.$message.error("创建失败！")})).catch((function(e){t.$message.error(JSON.stringify(e.response.data.errorDes))}))):"1"===this.activeName&&"确认"===this.next_step&&(delete this.form.vmsTemplate,!1===this.svm&&(delete this.form.vmConfig.properties.safeType,delete this.form.vmConfig.properties.secureVmType,delete this.form.vmConfig.properties.dpiVmType),1===this.form.vmSize&&(delete this.form.vmSize,delete this.form.namePostfixIndex),this.form.vmConfig.memory.quantityMB=1024*this.form.vmConfig.memory.quantityMB,console.log("form",this.form),this.$http.post("automation/api/huawei/clone_vms/?id=".concat(this.template_id),this.form,{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){200===e.status||201===e.status?(t.$message.success("创建成功！"),t.editVisible=!1,t.getData()):t.$message.error("创建失败！")})).catch((function(e){t.$message.error(JSON.stringify(e.response.data.errorDes))})))},handleVMClick:function(t,e){console.log(t,e)},handleCPUChange:function(){"低"===this.cpu_share?this.form.vmConfig.cpu.weight=250*this.form.vmConfig.cpu.quantity:"中"===this.cpu_share?this.form.vmConfig.cpu.weight=500*this.form.vmConfig.cpu.quantity:"高"===this.cpu_share&&(this.form.vmConfig.cpu.weight=1e3*this.form.vmConfig.cpu.quantity)},handleMemChange:function(){"低"===this.mem_share?this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*5:"中"===this.mem_share?this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*10:"高"===this.mem_share&&(this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*20)},showSystemInfo:function(){this.show_system=!this.show_system,">>"===this.arrow?this.arrow="<<":this.arrow=">>"},showCPUInfo:function(){this.show_cpu=!this.show_cpu,"el-icon-caret-right"===this.cpu_arrow_icon?this.cpu_arrow_icon="el-icon-caret-bottom":this.cpu_arrow_icon="el-icon-caret-right"},showMemInfo:function(){this.show_mem=!this.show_mem,"el-icon-caret-right"===this.mem_arrow_icon?this.mem_arrow_icon="el-icon-caret-bottom":this.mem_arrow_icon="el-icon-caret-right"},showNetworkInfo:function(){this.show_network=!this.show_network,"el-icon-caret-right"===this.network_arrow_icon?this.network_arrow_icon="el-icon-caret-bottom":this.network_arrow_icon="el-icon-caret-right"},showDiskInfo:function(){this.show_disk=!this.show_disk,"el-icon-caret-right"===this.disk_arrow_icon?this.disk_arrow_icon="el-icon-caret-bottom":this.disk_arrow_icon="el-icon-caret-right"},handleBandCategory:function(){this.cpu_disabled=!this.cpu_disabled},handleCpuShare:function(){"自定义"===this.cpu_share?this.cpu_share_disabled=!1:"低"===this.cpu_share?(this.form.vmConfig.cpu.weight=250*this.form.vmConfig.cpu.quantity,this.cpu_share_disabled=!0):"中"===this.cpu_share?(this.form.vmConfig.cpu.weight=500*this.form.vmConfig.cpu.quantity,this.cpu_share_disabled=!0):"高"===this.cpu_share&&(this.form.vmConfig.cpu.weight=1e3*this.form.vmConfig.cpu.quantity,this.cpu_share_disabled=!0)},handleMemShare:function(){"自定义"===this.mem_share?this.mem_share_disabled=!1:"低"===this.mem_share?(this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*5,this.mem_share_disabled=!0):"中"===this.mem_share?(this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*10,this.mem_share_disabled=!0):"高"===this.mem_share&&(this.form.vmConfig.memory.weight=1024*this.form.vmConfig.memory.quantityMB*20,this.mem_share_disabled=!0)},handleAddVmSize:function(){this.form.vmSize>1?this.postfix_index_disabled=!1:this.postfix_index_disabled=!0},handleLargePageConfig:function(){"未开启"!==this.form.large_page_config?(this.mem_reserve_disabled=!0,this.mem_limit_disabled=!0):(this.mem_reserve_disabled=!1,this.mem_limit_disabled=!1)},handleSelectVolType:function(){3===this.form.vmConfig.disks[0].volType&&(this.form.vmConfig.disks[0].isThin=!0)},handleSwitchSvm:function(){!0===this.svm&&(this.form.vmConfig.properties.safeType="secureVmType",this.form.vmConfig.properties.secureVmType="GVM")},handleSwitchSecureVm:function(){"dpiVmType"===this.form.vmConfig.properties.safeType?(this.form.vmConfig.properties.dpiVmType=this.secureVmTypeTo,delete this.form.vmConfig.properties.secureVmType):"secureVmType"===this.form.vmConfig.properties.safeType&&(this.form.vmConfig.properties.secureVmType=this.secureVmTypeTo,delete this.form.vmConfig.properties.dpiVmType)},handleSwitchSecurityGroup:function(){this.form.vmConfig.nics[0].enableSecurityGroup?this.form.vmConfig.nics[0].securityGroupId="":delete this.form.vmConfig.nics[0].securityGroupId},handleRestoreDefault:function(){this.form.vmConfig.properties.clockMode="freeClock",this.form.vmConfig.properties.bootFirmware="BIOS",this.form.vmConfig.properties.evsAffinity=!1,this.form.vmConfig.properties.bootFirmwareTime=0,this.form.vmConfig.properties.bootOption="disk",this.form.vmConfig.properties.vmVncKeymapSetting=7,this.form.vmConfig.properties.isAutoAdjustNuma=!1,this.form.vmConfig.properties.safeType="secureVmType",this.form.vmConfig.properties.secureVmType="GVM",this.svm=!1},handleSelectBootFirmware:function(t){this.firmware_time_disabled="UEFI"===t},handleCreate:function(){this.active=0,this.activeName="0",this.next_step="下一步",this.prev_disabled=!0,this.locationTo="",this.editVisible=!0,this.form={name:"New Virtual Machine",description:"",parentObjUrn:"",vmsTemplate:"",location:"",osOptions:{osType:"Windows",osVersion:""},vmConfig:{cpu:{weight:1e3,reservation:0,quantity:2,limit:0,coresPerSocket:1},memory:{quantityMB:4,reservation:0,weight:40960,limit:0},disks:[{datastoreUrn:"",name:"autoDS_CNA001",quantityGB:40,sequenceNum:1,isThin:!1,pciType:"VIRTIO",volType:1}],nics:[{sequenceNum:0,portGroupUrn:"",virtIo:1,nicConfig:{vringbuf:256,queues:1},enableSecurityGroup:!1}],properties:{clockMode:!1,bootFirmware:"BIOS",evsAffinity:!1,bootFirmwareTime:0,bootOption:"disk",vmVncKeymapSetting:7,isAutoAdjustNuma:!1,safeType:"secureVmType"}},isBindingHost:!1,autoBoot:!0,vmSize:1,namePostfixIndex:0},this.show_cpu=!1,this.cpu_arrow_icon="el-icon-caret-right",this.show_mem=!1,this.mem_arrow_icon="el-icon-caret-right",this.show_network=!1,this.network_arrow_icon="el-icon-caret-right",this.show_disk=!1,this.disk_arrow_icon="el-icon-caret-right",this.cpu_share="中",this.mem_share="中",this.selectOsType(),this.getDatastore(),this.cpu_band_category_options=["prefer"],this.cpu_share_options=["低","中","高","自定义"],this.large_page_config_options=["未开启","2M","1G"],this.config_mode_options=[{name:"普通延迟置零",value:1},{name:"普通",value:0},{name:"精简",value:3}],this.disk_mode_options=["从属","独立-持久","独立-非持久"],this.bus_type_options=["VIRTIO","IDE","SCSI"],this.network_type_options=[{name:"virtio",value:1}],this.IO_ring_num_options=[256,512,1024,2048,4096],this.gpu_options=["Cirrus","VGA"],this.gpu_size_options=[4],this.boot_mode_options=[{name:"网络启动",value:"pxe"},{name:"光驱启动",value:"cdrom"},{name:"硬盘启动",value:"disk"}],this.getFloppydriver(),this.getVNCKeyboard(),this.security_type_options=[{name:"防病毒",value:"secureVmType"},{name:"DPI",value:"dpiVmType"}],this.vm_security_type_options=["GVM","SVM"]},selectOsType:function(){var t=this;this.$http.get("automation/api/huawei/vms/osversions/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){"Windows"===t.form.osOptions.osType?(t.form.osOptions.osVersion=203,t.os_version_options=e.data.windows):"Linux"===t.form.osOptions.osType?(t.form.osOptions.osVersion=169,t.os_version_options=e.data.linux):(t.form.osOptions.osVersion=401,t.os_version_options=e.data.other)})).catch((function(e){console.log(e),t.$message.error("查询失败！")}))},getFloppydriver:function(){var t=this;this.$http.get("automation/api/huawei/queryVfdFiles/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.floppy_drive_options=e.data.VfdFiles})).catch((function(e){console.log(e),t.$message.error("查询失败！")}))},getVNCKeyboard:function(){var t=this;this.$http.get("automation/api/huawei/vncKeymapSettings/",{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){t.vnc_keyboard_options=e.data.vmVncKeymapSettings})).catch((function(e){console.log(e),t.$message.error("查询失败！")}))},handleAutoBoot:function(){this.form.autoBoot=!this.form.autoBoot},handleStopVms:function(t,e){this.id=e.id,this.vms_name=e.name,this.stopVisible=!0},stopVms:function(){var t=this;this.$http.post("automation/api/huawei/stop_vms/?id=".concat(this.id),{mode:"safe"},{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){200===e.status||201===e.status?(t.$message.success("虚拟机停止成功！"),t.stopVisible=!1,t.getData()):(t.$message.error("虚拟机停止失败！"),t.stopVisible=!1)})).catch((function(e){t.$message.error(JSON.stringify(e.response.data.errorDes)),t.stopVisible=!1}))},handleStartVms:function(t,e){this.id=e.id,this.vms_name=e.name,this.startVisible=!0},startVms:function(){var t=this;this.$http.post("automation/api/huawei/start_vms/?id=".concat(this.id),null,{headers:{token:this.token,env:sessionStorage.getItem("huaweiyun_env")}}).then((function(e){200===e.status||201===e.status?(t.$message.success("虚拟机开启成功！"),t.startVisible=!1,t.getData()):(t.$message.error("虚拟机开启失败！"),t.startVisible=!1)})).catch((function(e){t.$message.error(JSON.stringify(e.response.data.errorDes)),t.startVisible=!1}))},handlePageChange:function(t){this.$set(this.query,"pageIndex",t),this.getData()}}}),r=a,n=(i("93d2"),i("2877")),l=Object(n["a"])(r,o,s,!1,null,"ddbc6d4c",null);e["default"]=l.exports},"93d2":function(t,e,i){"use strict";var o=i("e193"),s=i.n(o);s.a},d81d:function(t,e,i){"use strict";var o=i("23e7"),s=i("b727").map,a=i("1dde"),r=i("ae40"),n=a("map"),l=r("map");o({target:"Array",proto:!0,forced:!n||!l},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},e193:function(t,e,i){}}]);