(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e35ea16"],{"2c33":function(e,t,r){e.exports=r.p+"assets/img/colse_eye.png"},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var s=r("1d80"),i=r("5899"),a="["+i+"]",n=RegExp("^"+a+a+"*"),o=RegExp(a+a+"*$"),l=function(e){return function(t){var r=String(s(t));return 1&e&&(r=r.replace(n,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},7156:function(e,t,r){var s=r("861d"),i=r("d2bb");e.exports=function(e,t,r){var a,n;return i&&"function"==typeof(a=t.constructor)&&a!==r&&s(n=a.prototype)&&n!==r.prototype&&i(e,n),e}},7608:function(e,t,r){},a9e3:function(e,t,r){"use strict";var s=r("83ab"),i=r("da84"),a=r("94ca"),n=r("6eeb"),o=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),d=r("d039"),f=r("7c73"),p=r("241c").f,h=r("06cf").f,m=r("9bf2").f,g=r("58a8").trim,b="Number",v=i[b],y=v.prototype,_=l(f(y))==b,w=function(e){var t,r,s,i,a,n,o,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=g(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:s=2,i=49;break;case 79:case 111:s=8,i=55;break;default:return+c}for(a=c.slice(2),n=a.length,o=0;o<n;o++)if(l=a.charCodeAt(o),l<48||l>i)return NaN;return parseInt(a,s)}return+c};if(a(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var k,x=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof x&&(_?d((function(){y.valueOf.call(r)})):l(r)!=b)?c(new v(w(t)),r,x):w(t)},$=s?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;$.length>C;C++)o(v,k=$[C])&&!o(x,k)&&m(x,k,h(v,k));x.prototype=y,y.constructor=x,n(i,b,x)}},afdf:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}})],1),r("div",{staticClass:"container"},[r("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[r("div",[e.hasPerm("sys:user:add")?r("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleCreate}},[e._v("新增")]):e._e()],1),r("div",[r("el-input",{staticStyle:{width:"200px","margin-bottom":"15px"},attrs:{type:"text",placeholder:"请输入用户名",clearable:""},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e.hasPerm("sys:user:list")?r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]):e._e()],1)]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","max-height":"600"}},[r("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center",width:"120"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{prop:"phone",label:"电话",align:"center"}}),r("el-table-column",{attrs:{prop:"create_time",label:"创建时间",formatter:e.datetimeFormat,align:"center","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{prop:"roles",formatter:e.roleFormat,label:"角色",align:"center","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPerm("sys:user:assign_role")?r("el-button",{staticClass:"color-link",attrs:{type:"text",icon:"el-icon-s-custom"},on:{click:function(r){return e.handleRole(t.$index,t.row)}}},[e._v("分配角色")]):e._e(),e.hasPerm("sys:user:modify")?r("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]):e._e(),e.hasPerm("sys:user:reset_pwd")?r("el-button",{staticClass:"color-link",attrs:{type:"text",icon:"el-icon-refresh"},on:{click:function(r){return e.handleReset(t.$index,t.row)}}},[e._v("重置密码")]):e._e(),e.hasPerm("sys:user:delete")?r("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),r("el-dialog",{attrs:{title:e.title,visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),"新增"===this.title?r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:this.registration_data.pwdType},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),this.form.password?r("img",{staticClass:"eye",attrs:{src:this.registration_data.src},on:{click:e.changeType}}):e._e()],1):e._e(),"新增"===this.title?r("el-form-item",{attrs:{label:"确认密码",prop:"confirm_pwd"}},[r("el-input",{attrs:{type:this.registration_data.pwdConfirmType},model:{value:e.form.confirm_pwd,callback:function(t){e.$set(e.form,"confirm_pwd",t)},expression:"form.confirm_pwd"}}),this.form.confirm_pwd?r("img",{staticClass:"eye",attrs:{src:this.registration_data.srcConfirm},on:{click:e.changeConfirmType}}):e._e()],1):e._e(),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),r("el-form-item",{attrs:{label:"电话",prop:"phone"}},[r("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"分配角色",visible:e.assignVisible,width:"30%"},on:{"update:visible":function(t){e.assignVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.assign_form,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"角色"}},[r("el-checkbox-group",{model:{value:e.assign_form.roles,callback:function(t){e.$set(e.assign_form,"roles",t)},expression:"assign_form.roles"}},e._l(e.check_roles,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name)+" ")])})),1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.assignVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.assignRole}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"提示",visible:e.resetVisible,width:"25%"},on:{"update:visible":function(t){e.resetVisible=t}}},[r("span",[e._v("确定要重置密码吗？")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.resetVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.resetPwd}},[e._v("确 定")])],1)]),r("el-dialog",{attrs:{title:"提示",visible:e.deleteVisible,width:"25%"},on:{"update:visible":function(t){e.deleteVisible=t}}},[r("span",[e._v("确定要删除用户 "+e._s(e.username)+" 吗？")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.deleteVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.deleteUser}},[e._v("确 定")])],1)])],1)},i=[],a=(r("99af"),r("d81d"),r("b0c0"),r("b85c")),n=r("424b"),o=r("c54a"),l={name:"usertable",data:function(){var e=this,t=function(t,r,s){""===r?s(new Error("请再次输入新密码")):r!==e.form.password?s(new Error("两次输入密码不一致!")):s()};return{registration_data:{pwdType:"password",pwdConfirmType:"password",src:r("2c33"),srcConfirm:r("2c33")},check_roles:[],keywords:"",title:"",query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,assignVisible:!1,deleteVisible:!1,resetVisible:!1,pageTotal:0,form:{},assign_form:{roles:[]},datetimeFormat:null,loading:!0,idx:-1,id:-1,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 位之间",trigger:"blur"}],confirm_pwd:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:t,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:o["validateEMail"],trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{validator:o["validatePhoneTwo"],trigger:"blur"}]},username:""}},created:function(){this.token=localStorage.getItem("token"),this.username=localStorage.getItem("username"),this.getData(),this.datetimeFormat=n["datetimeFormat"]},methods:{changeType:function(){this.registration_data.pwdType="password"===this.registration_data.pwdType?"text":"password",this.registration_data.src=this.registration_data.src==r("2c33")?r("fc5e7"):r("2c33")},changeConfirmType:function(){this.registration_data.pwdConfirmType="password"===this.registration_data.pwdConfirmType?"text":"password",this.registration_data.srcConfirm=this.registration_data.srcConfirm==r("2c33")?r("fc5e7"):r("2c33")},roleFormat:function(e){if(e.roles===[])return"";var t,r="",s=Object(a["a"])(e.roles);try{for(s.s();!(t=s.n()).done;){var i=t.value;r+=" "+i.name}}catch(n){s.e(n)}finally{s.f()}return r},getData:function(){var e=this,t=this.keywords,r=this.url;r=t?"sys/api/user/?username=".concat(t,"&current_page=").concat(this.query.pageIndex,"&pre_page=").concat(this.query.pageSize):"sys/api/user/?current_page=".concat(this.query.pageIndex,"&pre_page=").concat(this.query.pageSize),this.$http.get("".concat(r),{headers:{token:this.token}}).then((function(t){e.tableData=t.data.data,e.pageTotal=t.data.total_count,e.loading=!1})).catch((function(t){console.log(t),e.$message.error(JSON.stringify(t.response.data)),e.loading=!1}))},handleSearch:function(){this.$set(this.query,"pageIndex",1),this.getData()},handleDelete:function(e,t){this.id=t.id,this.form=t,this.username=t.username,this.deleteVisible=!0},deleteUser:function(){var e=this;this.$http.put("sys/api/user/delete/",{ids:[this.id]},{headers:{token:this.token}}).then((function(t){200===t.status?(e.$message.success("删除成功！"),e.deleteVisible=!1,e.getData()):e.$message.error("删除失败！")})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var r=0;r<e;r++)t+=this.multipleSelection[r].name+" ";this.$message.error("删除了".concat(t)),this.multipleSelection=[]},handleReset:function(e,t){this.id=t.id,this.resetVisible=!0},resetPwd:function(){var e=this;this.$http.get("sys/api/user/".concat(this.id,"/reset_pwd/"),{headers:{token:this.token}}).then((function(t){200===t.status?(e.$message.success("密码重置成功！"),e.resetVisible=!1,e.getData()):e.$message.error("密码重置失败！")})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},handleEdit:function(e,t){var r=this;this.id=t.id,this.form=t,this.title="编辑",this.editVisible=!0,this.$nextTick((function(){r.$refs.form.clearValidate()}))},handleCreate:function(){var e=this;this.title="新增",this.editVisible=!0,this.$nextTick((function(){e.$refs.form.clearValidate()})),this.form={role:[]},this.registration_data.pwdType=this.registration_data.pwdConfirmType="password",this.registration_data.src=this.registration_data.srcConfirm=r("2c33")},saveEdit:function(){var e=this;"编辑"===this.title?this.$refs.form.validate((function(t){if(!t)return e.$message.warning("参数错误"),!1;e.$http.put("sys/api/user/".concat(e.id,"/"),e.form,{headers:{token:e.token}}).then((function(t){200===t.status?(e.$message.success("修改成功！"),e.editVisible=!1,e.getData()):e.$message.error("修改失败！")})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))})):this.$refs.form.validate((function(t){if(!t)return e.$message.warning("参数错误"),!1;e.$http.post("sys/api/user/",e.form,{headers:{token:e.token}}).then((function(t){200===t.status||201===t.status?(e.$message.success("创建成功！"),e.editVisible=!1,e.getData()):e.$message.error("创建失败！")})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))}))},getCheckRoles:function(){var e=this;this.$http.get("sys/api/role/",{headers:{token:this.token}}).then((function(t){e.check_roles=t.data})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},handleRole:function(e,t){this.getCheckRoles(),this.id=t.id,this.roles=this.roleFormat(t);var r=[];t.roles.map((function(e){r.push(e.id)})),this.assign_form.roles=r,this.assignVisible=!0},assignRole:function(){var e=this;this.$http.put("sys/api/user/".concat(this.id,"/assign_user/"),this.assign_form,{headers:{token:this.token}}).then((function(t){200===t.status?(e.$message.success("角色分配成功！"),e.assignVisible=!1,e.getData()):e.$message.error("角色分配失败！")})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},handlePageChange:function(e){this.$set(this.query,"pageIndex",e),this.getData()}}},c=l,u=(r("c4b1"),r("2877")),d=Object(u["a"])(c,s,i,!1,null,"2c37a8a2",null);t["default"]=d.exports},c4b1:function(e,t,r){"use strict";var s=r("7608"),i=r.n(s);i.a},c54a:function(e,t,r){"use strict";r.r(t),r.d(t,"validateIP",(function(){return s})),r.d(t,"validateMac",(function(){return i})),r.d(t,"validateCh",(function(){return a})),r.d(t,"validatePhoneTwo",(function(){return n})),r.d(t,"validateEMail",(function(){return o})),r.d(t,"isInteger",(function(){return l}));r("a9e3");function s(e,t,r){if(""==t||void 0==t||null==t)r();else{var s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;s.test(t)||""==t?r():r(new Error("请输入正确的IP地址"))}}function i(e,t,r){if(""==t||void 0==t||null==t)r();else{var s=/[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}/;s.test(t)||""==t?r():r(new Error("请输入正确的MAC地址"))}}function a(e,t,r){if(""==t||void 0==t||null==t)r();else{var s=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi;s.test(t)?r(new Error("名称不能含有中文")):r()}}function n(e,t,r){var s=/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/;""==t||void 0==t||null==t||s.test(t)||""==t?r():r(new Error("请输入正确的电话号码或者固话号码"))}function o(e,t,r){var s=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;""==t||void 0==t||null==t||s.test(t)?r():r(new Error("请输入正确的邮箱地址"))}function l(e,t,r){if(!t)return r(new Error("输入不可以为空"));setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,s=e.test(t);s?r():r(new Error("请输入数字"))}else r(new Error("请输入数字"))}),0)}},d81d:function(e,t,r){"use strict";var s=r("23e7"),i=r("b727").map,a=r("1dde"),n=r("ae40"),o=a("map"),l=n("map");s({target:"Array",proto:!0,forced:!o||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},fc5e7:function(e,t,r){e.exports=r.p+"assets/img/open_eye.png"}}]);