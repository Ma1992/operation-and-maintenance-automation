(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c297a48"],{1148:function(t,e,a){"use strict";var n=a("a691"),r=a("1d80");t.exports="".repeat||function(t){var e=String(r(this)),a="",l=n(t);if(l<0||l==1/0)throw RangeError("Wrong number of repetitions");for(;l>0;(l>>>=1)&&(e+=e))1&l&&(a+=e);return a}},"159b":function(t,e,a){var n=a("da84"),r=a("fdbc"),l=a("17c2"),s=a("9112");for(var o in r){var i=n[o],u=i&&i.prototype;if(u&&u.forEach!==l)try{s(u,"forEach",l)}catch(c){u.forEach=l}}},"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("d3b7"),a("e6cf");function n(t,e,a,n,r,l,s){try{var o=t[l](s),i=o.value}catch(u){return void a(u)}o.done?e(i):Promise.resolve(i).then(n,r)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(r,l){var s=t.apply(e,a);function o(t){n(s,r,l,o,i,"next",t)}function i(t){n(s,r,l,o,i,"throw",t)}o(void 0)}))}}},"408a":function(t,e,a){var n=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=n(t))throw TypeError("Incorrect invocation");return+t}},4958:function(t,e,a){"use strict";var n=a("e84e"),r=a.n(n);r.a},"96cf":function(t,e,a){var n=function(t){"use strict";var e,a=Object.prototype,n=a.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},l=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function i(t,e,a,n){var r=e&&e.prototype instanceof f?e:f,l=Object.create(r.prototype),s=new T(n||[]);return l._invoke=A(t,a,s),l}function u(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(n){return{type:"throw",arg:n}}}t.wrap=i;var c="suspendedStart",h="suspendedYield",p="executing",d="completed",g={};function f(){}function m(){}function b(){}var v={};v[l]=function(){return this};var y=Object.getPrototypeOf,S=y&&y(y(I([])));S&&S!==a&&n.call(S,l)&&(v=S);var N=b.prototype=f.prototype=Object.create(v);function D(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function L(t,e){function a(r,l,s,o){var i=u(t[r],t,l);if("throw"!==i.type){var c=i.arg,h=c.value;return h&&"object"===typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){a("next",t,s,o)}),(function(t){a("throw",t,s,o)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return a("throw",t,s,o)}))}o(i.arg)}var r;function l(t,n){function l(){return new e((function(e,r){a(t,n,e,r)}))}return r=r?r.then(l,l):l()}this._invoke=l}function A(t,e,a){var n=c;return function(r,l){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===r)throw l;return x()}a.method=r,a.arg=l;while(1){var s=a.delegate;if(s){var o=E(s,a);if(o){if(o===g)continue;return o}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===c)throw n=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=p;var i=u(t,e,a);if("normal"===i.type){if(n=a.done?d:h,i.arg===g)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n=d,a.method="throw",a.arg=i.arg)}}}function E(t,a){var n=t.iterator[a.method];if(n===e){if(a.delegate=null,"throw"===a.method){if(t.iterator["return"]&&(a.method="return",a.arg=e,E(t,a),"throw"===a.method))return g;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=u(n,t.iterator,a.arg);if("throw"===r.type)return a.method="throw",a.arg=r.arg,a.delegate=null,g;var l=r.arg;return l?l.done?(a[t.resultName]=l.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=e),a.delegate=null,g):l:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,g)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function I(t){if(t){var a=t[l];if(a)return a.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function a(){while(++r<t.length)if(n.call(t,r))return a.value=t[r],a.done=!1,a;return a.value=e,a.done=!0,a};return s.next=s}}return{next:x}}function x(){return{value:e,done:!0}}return m.prototype=N.constructor=b,b.constructor=m,b[o]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,o in t||(t[o]="GeneratorFunction")),t.prototype=Object.create(N),t},t.awrap=function(t){return{__await:t}},D(L.prototype),L.prototype[s]=function(){return this},t.AsyncIterator=L,t.async=function(e,a,n,r,l){void 0===l&&(l=Promise);var s=new L(i(e,a,n,r),l);return t.isGeneratorFunction(a)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},D(N),N[o]="Generator",N[l]=function(){return this},N.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){while(e.length){var n=e.pop();if(n in t)return a.value=n,a.done=!1,a}return a.done=!0,a}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var a=this;function r(n,r){return o.type="throw",o.arg=t,a.next=n,r&&(a.method="next",a.arg=e),!!r}for(var l=this.tryEntries.length-1;l>=0;--l){var s=this.tryEntries[l],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var i=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var l=r;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=e&&e<=l.finallyLoc&&(l=null);var s=l?l.completion:{};return s.type=t,s.arg=e,l?(this.method="next",this.next=l.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),w(a),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,a,n){return this.delegate={iterator:I(t),resultName:a,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=n}catch(r){Function("r","regeneratorRuntime = r")(n)}},a434:function(t,e,a){"use strict";var n=a("23e7"),r=a("23cb"),l=a("a691"),s=a("50c4"),o=a("7b0b"),i=a("65f0"),u=a("8418"),c=a("1dde"),h=a("ae40"),p=c("splice"),d=h("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,f=Math.min,m=9007199254740991,b="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!d},{splice:function(t,e){var a,n,c,h,p,d,v=o(this),y=s(v.length),S=r(t,y),N=arguments.length;if(0===N?a=n=0:1===N?(a=0,n=y-S):(a=N-2,n=f(g(l(e),0),y-S)),y+a-n>m)throw TypeError(b);for(c=i(v,n),h=0;h<n;h++)p=S+h,p in v&&u(c,h,v[p]);if(c.length=n,a<n){for(h=S;h<y-n;h++)p=h+n,d=h+a,p in v?v[d]=v[p]:delete v[d];for(h=y;h>y-n+a;h--)delete v[h-1]}else if(a>n)for(h=y-n;h>S;h--)p=h+n-1,d=h+a-1,p in v?v[d]=v[p]:delete v[d];for(h=0;h<a;h++)v[h+S]=arguments[h+2];return v.length=y-n+a,c}})},b680:function(t,e,a){"use strict";var n=a("23e7"),r=a("a691"),l=a("408a"),s=a("1148"),o=a("d039"),i=1..toFixed,u=Math.floor,c=function(t,e,a){return 0===e?a:e%2===1?c(t,e-1,a*t):c(t*t,e/2,a)},h=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},p=i&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){i.call({})}));n({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,a,n,o,i=l(this),p=r(t),d=[0,0,0,0,0,0],g="",f="0",m=function(t,e){var a=-1,n=e;while(++a<6)n+=t*d[a],d[a]=n%1e7,n=u(n/1e7)},b=function(t){var e=6,a=0;while(--e>=0)a+=d[e],d[e]=u(a/t),a=a%t*1e7},v=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==d[t]){var a=String(d[t]);e=""===e?a:e+s.call("0",7-a.length)+a}return e};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(g="-",i=-i),i>1e-21)if(e=h(i*c(2,69,1))-69,a=e<0?i*c(2,-e,1):i/c(2,e,1),a*=4503599627370496,e=52-e,e>0){m(0,a),n=p;while(n>=7)m(1e7,0),n-=7;m(c(10,n,1),0),n=e-1;while(n>=23)b(1<<23),n-=23;b(1<<n),m(1,1),b(2),f=v()}else m(0,a),m(1<<-e,0),f=v()+s.call("0",p);return p>0?(o=f.length,f=g+(o<=p?"0."+s.call("0",p-o)+f:f.slice(0,o-p)+"."+f.slice(o-p))):f=g+f,f}})},c176:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),t._v(" LUN ")])],1)],1),a("div",{staticClass:"container"},[a("el-form",{ref:"form"},[a("el-form-item",{attrs:{label:"存储"}},[a("el-select",{staticClass:"selectIp",attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入存储主机名称或IP","remote-method":t.queryHost},on:{change:t.changeQueryHost},model:{value:t.storageHost,callback:function(e){t.storageHost=e},expression:"storageHost"}},t._l(t.hostData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.hostname+"/"+t.manage_ip,value:t}})})),1)],1)],1),a("el-tabs",{on:{"tab-click":t.handleStepOPtions},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},[a("el-tab-pane",{attrs:{label:"LUN",name:"1"}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:17}},[a("div",[a("el-button",{staticClass:"handle-box",attrs:{type:"primary"},on:{click:function(e){return t.handleAdd()}}},[t._v("创建 ")])],1)]),a("el-col",{attrs:{span:2}},[a("el-select",{model:{value:t.SearchName,callback:function(e){t.SearchName=e},expression:"SearchName"}},[a("el-option",{attrs:{label:"名称",value:"name"}}),a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"健康状态",value:"health"}}),a("el-option",{attrs:{label:"运行状态",value:"running"}})],1)],1),a("el-col",{staticClass:"mr10",attrs:{span:3}},["name"===t.SearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.nameSearch,callback:function(e){t.nameSearch=e},expression:"nameSearch"}}):t._e(),"id"===t.SearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.idSearch,callback:function(e){t.idSearch=e},expression:"idSearch"}}):t._e(),"health"===t.SearchName?a("el-select",{model:{value:t.healthSelect,callback:function(e){t.healthSelect=e},expression:"healthSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"正常",value:"1"}}),a("el-option",{attrs:{label:"故障",value:"2"}})],1):t._e(),"running"===t.SearchName?a("el-select",{model:{value:t.runningSelect,callback:function(e){t.runningSelect=e},expression:"runningSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"在线",value:"27"}}),a("el-option",{attrs:{label:"离线",value:"28"}}),a("el-option",{attrs:{label:"初始化中",value:"53"}})],1):t._e()],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small"},on:{click:t.queryLun}},[t._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.lunloading,expression:"lunloading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",data:t.tableData,border:""}},[a("af-table-column",{attrs:{prop:"NAME",label:"名称",align:"center"}}),a("af-table-column",{attrs:{prop:"HEALTHSTATUS",label:"健康状态",align:"center",formatter:t.handlehealthstatus}}),a("af-table-column",{attrs:{prop:"RUNNINGSTATUS",label:"运行状态",align:"center",formatter:t.handlerunningstatus}}),a("af-table-column",{attrs:{prop:"ALLOCTYPE",label:"类型",align:"center",formatter:t.handlealloctype}}),a("af-table-column",{attrs:{prop:"USAGETYPE",label:"使用类型",align:"center",formatter:t.handleusagetype}}),a("af-table-column",{attrs:{prop:"CAPACITY",label:"容量",align:"center",formatter:t.handlecapacity}}),a("af-table-column",{attrs:{prop:"PARENTNAME",label:"所属存储池",align:"center"}}),a("af-table-column",{attrs:{prop:"EXPOSEDTOINITIATOR",label:"映射状态",align:"center",formatter:t.handleexposedtoinitiator}})],1)],1),a("el-tab-pane",{attrs:{label:"LUN组",name:"2"}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:17}},[a("div",[a("el-button",{staticClass:"handle-box",attrs:{type:"primary"},on:{click:function(e){return t.handleAddlungroup()}}},[t._v("创建 ")])],1)]),a("el-col",{attrs:{span:2}},[a("el-select",{model:{value:t.lungroupSearchName,callback:function(e){t.lungroupSearchName=e},expression:"lungroupSearchName"}},[a("el-option",{attrs:{label:"名称",value:"name"}}),a("el-option",{attrs:{label:"ID",value:"id"}})],1)],1),a("el-col",{staticClass:"mr10",attrs:{span:3}},["name"===t.lungroupSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.lungroupnameSearch,callback:function(e){t.lungroupnameSearch=e},expression:"lungroupnameSearch"}}):t._e(),"id"===t.lungroupSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.lungroupidSearch,callback:function(e){t.lungroupidSearch=e},expression:"lungroupidSearch"}}):t._e()],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small"},on:{click:t.queryLunGroup}},[t._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.lunloading,expression:"lunloading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",data:t.lungrouptableData,border:"","highlight-current-row":""},on:{"row-click":t.selectlungroup}},[a("af-table-column",{attrs:{prop:"NAME",label:"名称",align:"center"}}),a("af-table-column",{attrs:{prop:"ID",label:"ID",align:"center"}}),a("af-table-column",{attrs:{prop:"CAPCITY",label:"LUN总容量",align:"center",formatter:t.handleluncapacity}})],1),a("el-col",[a("span",[t._v("选择LUN组查看对应LUN信息:")])]),a("el-col",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.luntableData,border:""}},[a("af-table-column",{attrs:{prop:"NAME",label:"名称",align:"center"}}),a("af-table-column",{attrs:{prop:"HEALTHSTATUS",label:"健康状态",align:"center",formatter:t.handlehealthstatus}}),a("af-table-column",{attrs:{prop:"RUNNINGSTATUS",label:"运行状态",align:"center",formatter:t.handlerunningstatus}}),a("af-table-column",{attrs:{prop:"ALLOCTYPE",label:"类型",align:"center",formatter:t.handlealloctype}}),a("af-table-column",{attrs:{prop:"CAPACITY",label:"容量",align:"center",formatter:t.handlecapacity}}),a("af-table-column",{attrs:{prop:"PARENTNAME",label:"所属存储池",align:"center"}}),a("af-table-column",{attrs:{prop:"EXPOSEDTOINITIATOR",label:"映射状态",align:"center",formatter:t.handleexposedtoinitiator}}),a("af-table-column",{attrs:{prop:"WWN",label:"WWN",align:"center"}})],1)],1)],1)],1)],1),a("el-dialog",{attrs:{title:"创建LUN",visible:t.addlunVisible,width:"32%"},on:{"update:visible":function(e){t.addlunVisible=e}}},[a("el-form",{ref:"lunform",attrs:{rules:t.lunrules,model:t.lunform,"label-width":"85px"}},[a("el-form-item",{attrs:{label:"名称",prop:"NAME"}},[a("el-input",{model:{value:t.lunform.NAME,callback:function(e){t.$set(t.lunform,"NAME",e)},expression:"lunform.NAME"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.lunform.DESCRIPTION,callback:function(e){t.$set(t.lunform,"DESCRIPTION",e)},expression:"lunform.DESCRIPTION"}})],1),a("el-form-item",{attrs:{label:"起始ID",required:t.idrequired}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{staticClass:"create-input",attrs:{id:"ID",disabled:t.iddisabled},model:{value:t.lunform.ID,callback:function(e){t.$set(t.lunform,"ID",e)},expression:"lunform.ID"}})],1),a("el-col",{attrs:{span:6}},[a("el-checkbox",{on:{change:t.handleID},model:{value:t.idchecked,callback:function(e){t.idchecked=e},expression:"idchecked"}},[t._v("自动分配")])],1)],1)],1),a("el-form-item",{attrs:{label:"使用类型"}},[a("el-select",{on:{change:function(e){return t.selectusagetype(e)}},model:{value:t.LUNUSAGETYPE,callback:function(e){t.LUNUSAGETYPE=e},expression:"LUNUSAGETYPE"}},t._l(t.usagetypeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t.smartthinshow?a("el-form-item",{attrs:{label:"SmartThin"}},[a("el-row",[a("el-checkbox",{on:{change:t.handlesmartthin},model:{value:t.smartthinchecked,callback:function(e){t.smartthinchecked=e},expression:"smartthinchecked"}},[t._v("启用")])],1),a("el-row",{staticClass:"span-height"},[a("span",[t._v("启用SmartThin功能后，存储系统将创建thin LUN，且不会一次性分配已设置的容量给该LUN。在该LUN容量范围内，存储系统会根据主机实际使用的容量动态分配存储资源，实现按需分配。")])])],1):t._e(),a("el-form-item",{attrs:{label:"所属存储池"}},[a("el-row",[a("el-select",{on:{change:function(e){return t.getcapacity(e)}},model:{value:t.LUNPARENTID,callback:function(e){t.LUNPARENTID=e},expression:"LUNPARENTID"}},t._l(t.parentidOptions,(function(t){return a("el-option",{key:t.NAME,attrs:{label:t.NAME,value:t}})})),1)],1),a("el-row",{staticClass:"span-height"},[a("span",[t._v("可用容量"+t._s(t.totalcapacity))])])],1),a("el-form",{ref:"capacityform",attrs:{rules:t.capacityrules,model:t.capacityform,"label-width":"85px"}},[t.capacityshow?a("el-form-item",{attrs:{label:"容量",prop:"CAPACITY"}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{staticClass:"create-input",attrs:{type:"number"},on:{input:t.handleaddlun},model:{value:t.capacityform.CAPACITY,callback:function(e){t.$set(t.capacityform,"CAPACITY",e)},expression:"capacityform.CAPACITY"}})],1),a("el-col",{attrs:{span:6}},[a("el-select",{on:{change:t.handlecapacityunit},model:{value:t.capacityunit,callback:function(e){t.capacityunit=e},expression:"capacityunit"}},t._l(t.capacityOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1)],1)],1)],1):t._e()],1),a("el-form-item",{attrs:{label:"数量",prop:"luncount"}},[a("el-row",[a("el-input",{staticClass:"create-input",attrs:{type:"number"},on:{input:t.handeluncount},model:{value:t.luncount,callback:function(e){t.luncount=e},expression:"luncount"}})],1),a("el-row",{staticClass:"span-height"},[a("span",[t._v("每次最多可创建500个LUN。当创建多个LUN时，系统会根据数量自动在输入的名称后增加后缀编号以示区分。您也可以手动指定后缀编号。")])]),a("el-row",[a("el-checkbox",{attrs:{disabled:t.luncountdisabled},on:{change:t.handlestartunit},model:{value:t.luncountchecked,callback:function(e){t.luncountchecked=e},expression:"luncountchecked"}},[t._v("手动指定后缀编号")])],1),a("el-row",[a("el-col",{attrs:{span:16}},[t.startnumbershow?a("el-form-item",{attrs:{label:"起始编号",prop:"startnumber"}},[a("el-input",{attrs:{type:"number"},on:{input:t.handlestartnumber},model:{value:t.startnumber,callback:function(e){t.startnumber=e},expression:"startnumber"}})],1):t._e()],1),a("el-col",{attrs:{span:6}},[t.startnumbershow?a("span",[t._v("(0~"+t._s(1e4-t.luncount)+")")]):t._e()])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addlunVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:t.savelunDisabled},on:{click:t.saveAddLunList}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"执行结果",visible:t.addresultVisible,width:"30%"},on:{"update:visible":function(e){t.addresultVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.resultData,border:""}},[a("af-table-column",{attrs:{prop:"name",label:"操作",align:"center"}}),a("af-table-column",{attrs:{prop:"status",label:"状态",align:"center"}}),a("af-table-column",{attrs:{prop:"reason",label:"失败原因和建议",align:"center"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.addresult}},[t._v("关闭")])],1)],1),a("el-dialog",{attrs:{title:"创建LUN组",visible:t.addgrouplunVisible,width:"77%"},on:{"update:visible":function(e){t.addgrouplunVisible=e}}},[a("el-form",{ref:"lungroupform",attrs:{rules:t.lungrouprules,model:t.lungroupform,"label-width":"85px"}},[a("el-form-item",{attrs:{label:"名称",prop:"NAME"}},[a("el-input",{model:{value:t.lungroupform.NAME,callback:function(e){t.$set(t.lungroupform,"NAME",e)},expression:"lungroupform.NAME"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.lungroupform.DESCRIPTION,callback:function(e){t.$set(t.lungroupform,"DESCRIPTION",e)},expression:"lungroupform.DESCRIPTION"}})],1),a("el-row",[a("el-col",{attrs:{span:11}},[a("p",{staticClass:"lungroup_create_p"},[t._v("可选LUN")]),a("el-row",{staticClass:"row-bg margin_bot",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:6}},[a("el-select",{model:{value:t.leftSearchName,callback:function(e){t.leftSearchName=e},expression:"leftSearchName"}},[a("el-option",{attrs:{label:"名称",value:"name"}}),a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"健康状态",value:"health"}}),a("el-option",{attrs:{label:"运行状态",value:"running"}})],1)],1),a("el-col",{staticClass:"mr10",attrs:{span:6}},["name"===t.leftSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.leftnameSearch,callback:function(e){t.leftnameSearch=e},expression:"leftnameSearch"}}):t._e(),"id"===t.leftSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.leftidSearch,callback:function(e){t.leftidSearch=e},expression:"leftidSearch"}}):t._e(),"health"===t.leftSearchName?a("el-select",{model:{value:t.lefthealthSelect,callback:function(e){t.lefthealthSelect=e},expression:"lefthealthSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"正常",value:"1"}}),a("el-option",{attrs:{label:"故障",value:"2"}})],1):t._e(),"running"===t.leftSearchName?a("el-select",{model:{value:t.leftrunningSelect,callback:function(e){t.leftrunningSelect=e},expression:"leftrunningSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"在线",value:"27"}}),a("el-option",{attrs:{label:"离线",value:"28"}}),a("el-option",{attrs:{label:"初始化中",value:"53"}})],1):t._e()],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"small"},on:{click:t.queryleftLun}},[t._v("搜索")])],1)],1),a("div",{staticClass:"div-height"},[a("el-table",{key:t.tableKey,ref:"lunTable",staticClass:"margin_bot",attrs:{"row-key":t.getRowKeys,data:t.nogrouptableData,border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handlelungroupChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"55"}}),a("af-table-column",{attrs:{prop:"NAME",label:"名称",align:"center"}}),a("af-table-column",{attrs:{prop:"PARENTNAME",label:"所属存储池",align:"center"}}),a("af-table-column",{attrs:{prop:"CAPACITY",label:"容量",align:"center",formatter:t.handlecapacity}}),a("af-table-column",{attrs:{prop:"ISADD2LUNGROUP",label:"已归属LUN组",align:"center",formatter:t.handleisadd2lungroup}})],1)],1),a("el-checkbox",{attrs:{label:"仅显示未归属于LUN组的LUN"},on:{change:t.handlegetLun},model:{value:t.LUNchecked,callback:function(e){t.LUNchecked=e},expression:"LUNchecked"}})],1),a("el-col",{staticClass:"trans_create_but",attrs:{span:2}},[a("el-button",{attrs:{type:"primary",disabled:!t.lungroupData.length,icon:"el-icon-arrow-right",circle:""},on:{click:t.addlun}}),a("br"),a("el-button",{staticStyle:{"margin-left":"0","margin-top":"10px"},attrs:{type:"primary",disabled:!t.selectedLunList.length,icon:"el-icon-arrow-left",circle:""},on:{click:t.removelun}})],1),a("el-col",{attrs:{span:11}},[a("p",{staticClass:"lungroup_create_p"},[t._v("已选LUN")]),a("el-row",{staticClass:"row-bg margin_bot",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:6}},[a("el-select",{model:{value:t.rightSearchName,callback:function(e){t.rightSearchName=e},expression:"rightSearchName"}},[a("el-option",{attrs:{label:"名称",value:"name"}}),a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"健康状态",value:"health"}}),a("el-option",{attrs:{label:"运行状态",value:"running"}})],1)],1),a("el-col",{staticClass:"mr10",attrs:{span:6}},["name"===t.rightSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.rightnameSearch,callback:function(e){t.rightnameSearch=e},expression:"rightnameSearch"}}):t._e(),"id"===t.rightSearchName?a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.rightidSearch,callback:function(e){t.rightidSearch=e},expression:"rightidSearch"}}):t._e(),"health"===t.rightSearchName?a("el-select",{model:{value:t.righthealthSelect,callback:function(e){t.righthealthSelect=e},expression:"righthealthSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"正常",value:"1"}}),a("el-option",{attrs:{label:"故障",value:"2"}})],1):t._e(),"running"===t.rightSearchName?a("el-select",{model:{value:t.rightrunningSelect,callback:function(e){t.rightrunningSelect=e},expression:"rightrunningSelect"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),a("el-option",{attrs:{label:"在线",value:"27"}}),a("el-option",{attrs:{label:"离线",value:"28"}}),a("el-option",{attrs:{label:"初始化中",value:"53"}})],1):t._e()],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"small"},on:{click:t.queryrightLun}},[t._v("搜索")])],1)],1),a("div",{staticClass:"div-height"},[a("el-table",{key:t.tableKey,ref:"selectedlunTable",attrs:{"row-key":t.getRowKeys,data:t.selectedLuntableData,border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectedLunChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"55"}}),a("af-table-column",{attrs:{prop:"NAME",label:"名称",align:"center"}}),a("af-table-column",{attrs:{prop:"PARENTNAME",label:"所属存储池",align:"center"}}),a("af-table-column",{attrs:{prop:"CAPACITY",label:"容量",align:"center",formatter:t.handlecapacity}}),a("af-table-column",{attrs:{prop:"ISADD2LUNGROUP",label:"已归属LUN组",align:"center",formatter:t.handleisadd2lungroup}})],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addgrouplunVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.createlungroup}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"执行结果",visible:t.addlungroupresultVisible,width:"30%"},on:{"update:visible":function(e){t.addlungroupresultVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.lungroupresultData,border:""}},[a("af-table-column",{attrs:{prop:"name",label:"操作",align:"center"}}),a("af-table-column",{attrs:{prop:"status",label:"状态",align:"center"}}),a("af-table-column",{attrs:{prop:"reason",label:"失败原因和建议",align:"center"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.addlungroupresult}},[t._v("关闭")])],1)],1)],1)},r=[],l=(a("99af"),a("4160"),a("caad"),a("c975"),a("a434"),a("b0c0"),a("b680"),a("d3b7"),a("25f0"),a("2532"),a("159b"),a("96cf"),a("1da1")),s={name:"LunGroup",data:function(){return{storageresult:{},storage_env:"",activeIndex:"1",tableData:[],copytableData:[],storageHost:"",addlunVisible:!1,lunform:{},LUNTYPE:0,lunrules:{NAME:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:31,message:"请输入字母、数字、 “_”、“-”、 “.”和中文字符",trigger:"blur"}],ID:[{message:"请输入ID",trigger:"input"}]},capacityform:{},capacityrules:{CAPACITY:[{required:!0,message:"请输入容量"},{trigger:"blur"}]},hostData:[],idchecked:!0,iddisabled:!0,idrequired:!1,usagetypeOptions:[{label:"普通LUN",value:"0"},{label:"PE LUN",value:"3"}],smartthinchecked:!1,parentidOptions:[],totalcapacity:0,lunloading:!1,addlunloading:!1,capacitychecked:!1,capacityOptions:[{value:"KB"},{value:"MB"},{value:"GB"},{value:"TB"}],capacityunit:"GB",luncountchecked:!1,luncountdisabled:!0,luncount:1,smartthinshow:!0,capacityshow:!0,startnumber:0,startnumbershow:!1,LUNUSAGETYPE:"普通LUN",LUNPARENTID:"",addresultVisible:!1,CAPACITY:"",resultData:[],lungrouptableData:[],addgrouplunVisible:!1,lungrouprules:{NAME:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:31,message:"请输入字母、数字、 “_”、“-”、 “.”和中文字符",trigger:"blur"}]},lungroupform:{},tree_title:["可选LUN","已选LUN"],fromDataTree:[],ISADD2LUNGROUP:"",nogrouptableData:[],selectedLunList:[],tableKey:0,lungroupData:[],selectedLuntableData:[],lungroupresultData:[],addlungroupresultVisible:!1,lunGroupSearchName:"name",lunGroupSearchValue:"",SearchName:"name",healthSelect:"全部",runningSelect:"全部",nameSearch:"",idSearch:"",lungroupSearchName:"name",lungroupnameSearch:"",lungroupidSearch:"",copylungrouptableData:[],luntableData:[],savelunDisabled:!0,LUNchecked:!0,leftSearchName:"name",leftnameSearch:"",leftidSearch:"",copynogrouptableData:[],lefthealthSelect:"全部",leftrunningSelect:"全部",copyselectedLuntableData:[],rightSearchName:"name",rightnameSearch:"",rightidSearch:"",righthealthSelect:"全部",rightrunningSelect:"全部",totalcapacitysectors:0}},created:function(){this.getData()},methods:{getLunList:function(){var t=this;this.lunloading=!0,this.$http.post("automation/api/storage/lun_list/?ISADD2LUNGROUP=".concat(this.ISADD2LUNGROUP),{manage_address:this.storageresult.manage_address,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_password},{headers:{token:localStorage.getItem("token")}}).then((function(e){t.tableData=e.data["data"],t.copytableData=t.tableData,t.lunloading=!1,t.nogrouptableData=t.tableData,t.copynogrouptableData=t.tableData;for(var a=0;a<t.copyselectedLuntableData.length;a++)for(var n=0;n<t.nogrouptableData.length;n++)t.copyselectedLuntableData[a]&&t.nogrouptableData[n]&&t.copyselectedLuntableData[a].NAME===t.nogrouptableData[n].NAME&&t.nogrouptableData.splice(n,1)})).catch((function(e){t.$message.error(JSON.stringify(e.response.data.msg)),t.lunloading=!1}))},getData:function(){var t=this;this.$http.get("asset/api/storage/?current_page=1&pre_page=1",{headers:{token:localStorage.getItem("token")}}).then((function(e){0!=e.data["data"].length?(sessionStorage.getItem("storage_env")?t.storage_env=JSON.parse(sessionStorage.getItem("storage_env")):(sessionStorage.setItem("storage_env",JSON.stringify(e.data["data"][0])),t.storage_env=e.data["data"][0]),t.storageresult=t.storage_env,t.getLunList(),t.storageHost=t.storage_env["hostname"]+"/"+t.storage_env["manage_ip"]):t.$message.error("未发现存储环境!")})).catch((function(e){console.log(e,9999),t.$message.error(JSON.stringify(e.response.data))}))},handlehealthstatus:function(t){return"1"==t.HEALTHSTATUS?"正常":"2"==t.HEALTHSTATUS?"故障":""},handlerunningstatus:function(t){return"53"==t.RUNNINGSTATUS?"初始化中":"27"==t.RUNNINGSTATUS?"在线":"28"==t.RUNNINGSTATUS?"离线":"19"==t.RUNNINGSTATUS?"正在格式化":""},handlealloctype:function(t){return"0"==t.ALLOCTYPE?"thick LUN":"1"==t.ALLOCTYPE?"thin LUN":""},handleusagetype:function(t){return"0"==t.USAGETYPE?"内部":"1"==t.USAGETYPE?"外部":"3"==t.USAGETYPE?"PE LUN":""},handlecapacity:function(t){var e;e=t.CAPACITY;var a=512*e/1024/1024,n=a/1024;return n>=1?(n=n.toString().substring(0,n.toString().indexOf(".")+4),n=parseFloat(n).toFixed(3),n+" GB"):parseFloat(a).toFixed(3)+" MB"},handleluncapacity:function(t){var e;e=t.CAPCITY;var a=512*e/1024/1024,n=a/1024;return n>=1?(n=n.toString().substring(0,n.toString().indexOf(".")+4),n=parseFloat(n).toFixed(3),n+" GB"):parseFloat(a).toFixed(3)+" MB"},handleexposedtoinitiator:function(t){return"false"==t.EXPOSEDTOINITIATOR?"未映射":"true"==t.EXPOSEDTOINITIATOR?"已映射":"未映射"},handleAdd:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading"});this.lunform={},this.capacityform={},this.capacityunit="GB",this.$set(this.lunform,"USAGETYPE","0"),this.$set(this.lunform,"ALLOCTYPE",0),this.$set(this.lunform,"WRITEPOLICY",1),this.idchecked=!0,this.iddisabled=!0,this.luncount=1,this.luncountchecked=!1,this.luncountdisabled=!0,this.startnumbershow=!1,this.startnumber=0,this.smartthinshow=!0,this.capacityshow=!0,this.copyselectedLuntableData=[],this.$http.post("automation/api/storage/nextavailableid/?type=11",{manage_address:this.storageresult.manage_address,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_password},{headers:{token:localStorage.getItem("token")}}).then((function(a){var n=a["data"]["ID"];n=parseInt(n)+1;var r=n.toString().length;1===r?t.$set(t.lunform,"NAME","LUN00"+n):2===r?t.$set(t.lunform,"NAME","LUN0"+n):t.$set(t.lunform,"NAME","LUN"+n),t.$http.post("automation/api/storage/storagepool_list/",{manage_address:t.storageresult.manage_address,manage_username:t.storageresult.manage_username,manage_password:t.storageresult.manage_password},{headers:{token:localStorage.getItem("token")}}).then((function(a){t.parentidOptions=a["data"],t.LUNPARENTID=t.parentidOptions[0].NAME,t.getcapacity(t.parentidOptions[0]),t.lunform.PARENTID=t.parentidOptions[0],e.close(),t.addlunVisible=!0,t.$nextTick((function(){t.$refs.lunform.clearValidate(),t.$refs.capacityform.clearValidate()}))})).catch((function(a){e.close(),t.$message.error(JSON.stringify(a.response.data.msg))}))})).catch((function(a){e.close(),t.$message.error(JSON.stringify(a.response.data.msg))}))},queryHost:function(t){var e=this;this.$http.get("asset/api/storage/storage/?query=".concat(t),{headers:{token:localStorage.getItem("token")}}).then((function(t){e.hostData=t.data})).catch((function(t){e.$message.error(JSON.stringify(t.response.data))}))},changeQueryHost:function(t){console.log(t,44444),sessionStorage.setItem("storage_env",JSON.stringify(t)),this.storageresult=t,this.storageHost=t.hostname+"/"+t.manage_ip,this.lungrouptableData=[],this.tableData=[],this.luntableData=[],"1"===this.activeIndex?this.getLunList():this.getlungroupList()},handleID:function(){this.iddisabled=!this.iddisabled,this.idrequired=!this.idrequired,this.iddisabled&&this.$set(this.lunform,"ID","")},getcapacity:function(t){console.log(t.DATASPACE,"DATASPACE");var e=t.DATASPACE;this.totalcapacitysectors=e;var a=512*e/1024/1024,n=a/1024;n>=1?(n=n.toString().substring(0,n.toString().indexOf(".")+4),n=parseFloat(n).toFixed(3),this.totalcapacity=n+" GB"):this.totalcapacity=parseFloat(a).toFixed(3)+" MB",console.log(this.totalcapacity,"totalcapacity"),this.$set(this.lunform,"PARENTID",this.LUNPARENTID)},selectusagetype:function(t){"3"===t?(this.smartthinshow=!1,this.capacityshow=!1,this.savelunDisabled=!1,this.$set(this.lunform,"WRITEPOLICY",2),this.$set(this.lunform,"PARENTTYPE",216),this.$set(this.lunform,"SUBTYPE",2)):(this.smartthinshow=!0,this.capacityshow=!0,this.$set(this.lunform,"WRITEPOLICY",1)),this.$set(this.lunform,"USAGETYPE",parseInt(this.LUNUSAGETYPE))},handeluncount:function(t){this.luncountdisabled=t<="1"},handlestartunit:function(){this.startnumbershow=!this.startnumbershow},handlesmartthin:function(){this.smartthinchecked?this.$set(this.lunform,"ALLOCTYPE",1):this.$set(this.lunform,"ALLOCTYPE",0)},saveAddLunList:function(){var t=this,e=function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.length,r=Object(e),l=0;case 3:if(!(l<n)){t.next=12;break}if(!(l in r)){t.next=9;break}return console.log("doing foreach..."),s=r[l],t.next=9,a(s,l,r);case 9:l++,t.next=3;break;case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();this.addresultVisible=!0,this.$set(this.lunform,"PARENTID",this.lunform.PARENTID.ID),this.LUNUSAGETYPE="普通LUN";var a=this.capacityform.CAPACITY;if(a&&("KB"===this.capacityunit?this.$set(this.lunform,"CAPACITY",1024*a/512):"MB"===this.capacityunit?this.$set(this.lunform,"CAPACITY",1024*a*1024/512):"GB"===this.capacityunit?this.$set(this.lunform,"CAPACITY",1024*a*1024*1024/512):this.$set(this.lunform,"CAPACITY",1024*a*1024*1024*1024/512)),this.$set(this.lunform,"manage_address",this.storageresult.manage_address),this.$set(this.lunform,"manage_username",this.storageresult.manage_username),this.$set(this.lunform,"manage_password",this.storageresult.manage_password),1===this.luncount){this.resultData=[];var n={name:this.lunform.NAME,status:"正在执行",reason:"",real_name:this.lunform.NAME};this.resultData.push(n),this.saveAddLun(n)}else if(0!=this.resultData.length)e(this.resultData,function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.saveAddLun(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else{for(var r=0;r<this.luncount;r++){var s=r.toString().length,o="",i="";1===s?(i=this.lunform.NAME+"000"+r,o="创建LUN "+i):2===s?(i=this.lunform.NAME+"00"+r,o="创建LUN "+i):3===s?(i=this.lunform.NAME+"0"+r,o="创建LUN "+i):(i=this.lunform.NAME+r,o="创建LUN "+i),this.resultData.push({name:o,status:"等待执行",reason:"",real_name:i})}e(this.resultData,function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.saveAddLun(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},saveAddLun:function(t){var e=this;return new Promise((function(a,n){e.lunform.NAME=t.real_name,t.status="正在执行",e.$http.post("automation/api/storage/create_lun/",e.lunform,{headers:{token:localStorage.getItem("token")}}).then((function(e){200===e.status&&(t.status="成功"),a(e),console.log(a,n,"resolve")})).catch((function(a){n(a),t.status="执行失败",t.reason=a.response.data.msg,e.$message.error(JSON.stringify(a.response.data.msg))}))}))},handlestartnumber:function(t){this.resultData=[];for(var e=0;e<this.luncount;e++){var a=t.toString().length,n="",r="";1===a?(r=this.lunform.NAME+"000"+t,n="创建LUN "+r):2===a?(r=this.lunform.NAME+"00"+t,n="创建LUN "+r):3===a?(r=this.lunform.NAME+"0"+t,n="创建LUN "+r):(r=this.lunform.NAME+t,n="创建LUN "+r),this.resultData.push({name:n,status:"等待执行",reason:"",real_name:r}),t=parseInt(t)+1}},addresult:function(){this.addresultVisible=!1,this.addlunVisible=!1,this.getLunList()},handleStepOPtions:function(t){"1"===t.name?(this.ISADD2LUNGROUP="",this.getLunList(this.storageresult)):(this.luntableData=[],this.getlungroupList())},getlungroupList:function(){var t=this;this.lunloading=!0,this.$http.post("automation/api/storage/lun_group_list/",{manage_address:this.storageresult.manage_address,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_password},{headers:{token:localStorage.getItem("token")}}).then((function(e){t.lungrouptableData=e.data["data"],t.copylungrouptableData=t.lungrouptableData,t.lunloading=!1})).catch((function(e){t.lunloading=!1,t.$message.error(JSON.stringify(e.response.data.msg))}))},handleAddlungroup:function(){var t=this;this.lungroupform={},this.selectedLuntableData=[];var e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading"});this.ISADD2LUNGROUP=!1,this.$http.post("automation/api/storage/nextavailableid/?type=256",{manage_address:this.storageresult.manage_address,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_passwords},{headers:{token:localStorage.getItem("token")}}).then((function(a){var n=a["data"]["ID"];n=parseInt(n)+1;var r=n.toString().length;1===r?t.$set(t.lungroupform,"NAME","LUNGroup00"+n):2===r?t.$set(t.lungroupform,"NAME","LUNGroup0"+n):t.$set(t.lungroupform,"NAME","LUNGroup"+n),e.close(),t.addgrouplunVisible=!0,t.$nextTick((function(){t.$refs.lungroupform.clearValidate()}))})).catch((function(a){e.close(),t.$message.error(JSON.stringify(a.response.data.msg))})),this.getLunList()},handlelungroupChange:function(t){var e=this;this.lungroupData=[],t&&t.forEach((function(t){t&&e.lungroupData.push(t)}))},addlun:function(){var t=this;setTimeout((function(){t.$refs["lunTable"].clearSelection(),t.$refs["selectedlunTable"].clearSelection()}),0),this.lungroupData.forEach((function(e){t.selectedLuntableData.push(e)})),this.copyselectedLuntableData=this.selectedLuntableData;for(var e=this.nogrouptableData.length-1;e>=0;e--)for(var a=0;a<this.lungroupData.length;a++)this.nogrouptableData[e]&&this.lungroupData[a]&&this.nogrouptableData[e].NAME===this.lungroupData[a].NAME&&this.nogrouptableData.splice(e,1)},removelun:function(){var t=this;setTimeout((function(){t.$refs["lunTable"].clearSelection(),t.$refs["selectedlunTable"].clearSelection()}),0),this.selectedLunList.forEach((function(e){t.nogrouptableData.push(e)}));for(var e=this.selectedLuntableData.length-1;e>=0;e--)for(var a=0;a<this.selectedLunList.length;a++)this.selectedLuntableData[e]&&this.selectedLunList[a]&&this.selectedLuntableData[e].NAME===this.selectedLunList[a].NAME&&this.selectedLuntableData.splice(e,1)},handleSelectedLunChange:function(t){var e=this;this.selectedLunList=[],t&&t.forEach((function(t){t&&e.selectedLunList.push(t)}))},handleisadd2lungroup:function(t){return"false"==t.ISADD2LUNGROUP?"否":"true"==t.ISADD2LUNGROUP?"是":""},getRowKeys:function(t){return t.NAME},createlungroup:function(){this.lungroupresultData=[];var t="创建LUN组 "+this.lungroupform.NAME,e={name:t,status:"正在执行",reason:""};this.lungroupresultData.push(e);for(var a=0;a<this.selectedLuntableData.length;a++){var n="增加LUN "+this.selectedLuntableData[a].NAME;this.lungroupresultData.push({name:n,status:"等待执行",reason:"",lun_id:this.selectedLuntableData[a].ID})}this.addlungroupresultVisible=!0,this.create_lun_group()},create_lun_group:function(){var t=this,e=function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.length,r=Object(e),l=0;case 3:if(!(l<n)){t.next=12;break}if(!(l in r)){t.next=9;break}return console.log("doing foreach..."),s=r[l],t.next=9,a(s,l,r);case 9:l++,t.next=3;break;case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();this.$http.post("automation/api/storage/create_lun_group/",{lun_group:this.lungroupform,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_password,manage_address:this.storageresult.manage_address},{headers:{token:localStorage.getItem("token")}}).then((function(a){var n=a.data;200===a.status?t.lungroupresultData[0].status="成功":(t.lungroupresultData[0].status="执行失败",t.lungroupresultData[0].reason=a.data),n&&e(t.lungroupresultData,function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(r>0)){e.next=3;break}return e.next=3,t.lungroupassociate(a,n.ID);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}))},lungroupassociate:function(t,e){var a=this;return new Promise((function(n,r){a.lungroupform.NAME=t.real_name,t.status="正在执行",a.$http.post("automation/api/storage/lun_group_associate/",{lun_associate:{ID:e,ASSOCIATEOBJTYPE:11,ASSOCIATEOBJID:t.lun_id},manage_username:a.storageresult.manage_username,manage_password:a.storageresult.manage_password,manage_address:a.storageresult.manage_address},{headers:{token:localStorage.getItem("token")}}).then((function(e){200===e.status?t.status="成功":(t.status="执行失败",t.reason=e.data),n(e),console.log(n,r,"resolve")})).catch((function(e){r(e),t.status="执行失败",t.reason=e.response.data.msg,a.$message.error(JSON.stringify(e.response.data.msg))}))}))},addlungroupresult:function(){this.addlungroupresultVisible=!1,this.addgrouplunVisible=!1,this.getlungroupList()},queryLun:function(){var t=this;"name"===this.SearchName?""!=this.nameSearch?(this.tableData=[],this.copytableData.forEach((function(e){var a=e.NAME.includes(t.nameSearch);!0===a&&t.tableData.push(e)}))):this.tableData=this.copytableData:"id"===this.SearchName?""!=this.idSearch?(this.tableData=[],this.copytableData.forEach((function(e){var a=e.ID.includes(t.idSearch);!0===a&&t.tableData.push(e)}))):this.tableData=this.copytableData:"health"===this.SearchName?"全部"===this.healthSelect||"all"===this.healthSelect?this.tableData=this.copytableData:(this.tableData=[],this.copytableData.forEach((function(e){var a=e.HEALTHSTATUS.includes(t.healthSelect);!0===a&&t.tableData.push(e)}))):"running"===this.SearchName&&("全部"===this.runningSelect||"all"===this.runningSelect?this.tableData=this.copytableData:(this.tableData=[],this.copytableData.forEach((function(e){var a=e.RUNNINGSTATUS.includes(t.runningSelect);!0===a&&t.tableData.push(e)}))))},queryLunGroup:function(){var t=this;console.log(this.lungroupSearchName,1111),"name"===this.lungroupSearchName?""!=this.lungroupnameSearch?(this.lungrouptableData=[],this.copylungrouptableData.forEach((function(e){var a=e.NAME.includes(t.lungroupnameSearch);!0===a&&t.lungrouptableData.push(e)}))):this.lungrouptableData=this.copylungrouptableData:"id"===this.lungroupSearchName&&(""!=this.lungroupidSearch?(this.lungrouptableData=[],this.copylungrouptableData.forEach((function(e){var a=e.ID.includes(t.lungroupidSearch);!0===a&&t.lungrouptableData.push(e)}))):this.lungrouptableData=this.copylungrouptableData)},selectlungroup:function(t){var e=this;this.luntableData=[],this.$http.post("automation/api/storage/associate_group/?TYPE=11&ASSOCIATEOBJTYPE=".concat(t.TYPE,"&ASSOCIATEOBJID=").concat(t.ID),{manage_address:this.storageresult.manage_address,manage_username:this.storageresult.manage_username,manage_password:this.storageresult.manage_password},{headers:{token:localStorage.getItem("token")}}).then((function(t){e.luntableData=t.data})).catch((function(t){e.$message.error(JSON.stringify(t.response.data.msg)),e.luntableData=[]}))},handleaddlun:function(){var t=0;"KB"===this.capacityunit?t=1024*this.capacityform.CAPACITY/512:"MB"===this.capacityunit?t=1024*this.capacityform.CAPACITY*1024/512:"GB"===this.capacityunit?(t=1024*this.capacityform.CAPACITY*1024*1024/512,console.log(t)):t=1024*this.capacityform.CAPACITY*1024*1024*1024/512,parseInt(t)>parseInt(this.totalcapacitysectors)?(this.$message.error("存储池的可用容量小于创建LUN所需总容量，请重新选择存储池或修改LUN的总容量"),this.savelunDisabled=!0):"3"===this.LUNUSAGETYPE?this.lunform.NAME&&this.luncount&&(this.savelunDisabled=!1):this.lunform.NAME&&this.capacityform.CAPACITY&&this.luncount&&(this.savelunDisabled=!1)},handlecapacityunit:function(){var t=0;"KB"===this.capacityunit?t=1024*this.capacityform.CAPACITY/512:"MB"===this.capacityunit?t=1024*this.capacityform.CAPACITY*1024/512:"GB"===this.capacityunit?(t=1024*this.capacityform.CAPACITY*1024*1024/512,console.log(t)):t=1024*this.capacityform.CAPACITY*1024*1024*1024/512,parseInt(t)>parseInt(this.totalcapacitysectors)?(this.$message.error("存储池的可用容量小于创建LUN所需总容量，请重新选择存储池或修改LUN的总容量"),this.savelunDisabled=!0):this.savelunDisabled=!1},handlegetLun:function(){!0===this.LUNchecked?(this.ISADD2LUNGROUP=!1,this.getLunList()):(this.ISADD2LUNGROUP="",this.getLunList())},queryleftLun:function(){var t=this;"name"===this.leftSearchName?""!=this.leftnameSearch?(this.nogrouptableData=[],this.copynogrouptableData.forEach((function(e){var a=e.NAME.includes(t.leftnameSearch);!0===a&&t.nogrouptableData.push(e)}))):this.nogrouptableData=this.copynogrouptableData:"id"===this.leftSearchName?""!=this.leftidSearch?(this.nogrouptableData=[],this.copynogrouptableData.forEach((function(e){var a=e.ID.includes(t.leftidSearch);!0===a&&t.nogrouptableData.push(e)}))):this.nogrouptableData=this.copynogrouptableData:"health"===this.leftSearchName?"全部"===this.lefthealthSelect||"all"===this.lefthealthSelect?this.nogrouptableData=this.copynogrouptableData:(this.nogrouptableData=[],this.copynogrouptableData.forEach((function(e){var a=e.HEALTHSTATUS.includes(t.lefthealthSelect);!0===a&&t.nogrouptableData.push(e)}))):"running"===this.leftSearchName&&("全部"===this.leftrunningSelect||"all"===this.leftrunningSelect?this.nogrouptableData=this.copynogrouptableData:(this.nogrouptableData=[],this.copynogrouptableData.forEach((function(e){var a=e.RUNNINGSTATUS.includes(t.leftrunningSelect);!0===a&&t.nogrouptableData.push(e)}))))},queryrightLun:function(){var t=this;"name"===this.rightSearchName?""!=this.rightnameSearch?(this.selectedLuntableData=[],this.copyselectedLuntableData.forEach((function(e){var a=e.NAME.includes(t.rightnameSearch);!0===a&&t.selectedLuntableData.push(e)}))):this.selectedLuntableData=this.copyselectedLuntableData:"id"===this.rightSearchName?""!=this.rightidSearch?(this.selectedLuntableData=[],this.copyselectedLuntableData.forEach((function(e){var a=e.ID.includes(t.rightidSearch);!0===a&&t.selectedLuntableData.push(e)}))):this.selectedLuntableData=this.copyselectedLuntableData:"health"===this.rightSearchName?"全部"===this.righthealthSelect||"all"===this.righthealthSelect?this.selectedLuntableData=this.copyselectedLuntableData:(this.selectedLuntableData=[],this.copyselectedLuntableData.forEach((function(e){var a=e.HEALTHSTATUS.includes(t.righthealthSelect);!0===a&&t.selectedLuntableData.push(e)}))):"running"===this.rightSearchName&&("全部"===this.rightrunningSelect||"all"===this.rightrunningSelect?this.selectedLuntableData=this.copyselectedLuntableData:(this.selectedLuntableData=[],this.copyselectedLuntableData.forEach((function(e){var a=e.RUNNINGSTATUS.includes(t.rightrunningSelect);!0===a&&t.selectedLuntableData.push(e)}))))}}},o=s,i=(a("4958"),a("2877")),u=Object(i["a"])(o,n,r,!1,null,"2b98d6b1",null);e["default"]=u.exports},e84e:function(t,e,a){}}]);