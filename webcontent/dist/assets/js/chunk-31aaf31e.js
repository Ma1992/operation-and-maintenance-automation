(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31aaf31e"],{"159b":function(e,a,t){var n=t("da84"),r=t("fdbc"),l=t("17c2"),s=t("9112");for(var c in r){var o=n[c],i=o&&o.prototype;if(i&&i.forEach!==l)try{s(i,"forEach",l)}catch(p){i.forEach=l}}},"6de0":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"crumbs"},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[t("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 端口检查日志 ")])],1)],1),t("div",{staticClass:"container"},[t("el-form",{attrs:{inline:!0},model:{value:e.searchData,callback:function(a){e.searchData=a},expression:"searchData"}},[t("el-row",[t("el-col",{attrs:{span:30,inline:!0}},[t("el-form-item",[t("el-input",{staticClass:"handle-input",attrs:{placeholder:"设备名",clearable:""},model:{value:e.searchData.device_name,callback:function(a){e.$set(e.searchData,"device_name",a)},expression:"searchData.device_name"}})],1),t("el-form-item",[t("el-input",{staticClass:"handle-input",attrs:{placeholder:"主机名",clearable:""},model:{value:e.searchData.hostname,callback:function(a){e.$set(e.searchData,"hostname",a)},expression:"searchData.hostname"}})],1),t("el-form-item",[t("el-input",{staticClass:"handle-input",attrs:{placeholder:"sn",clearable:""},model:{value:e.searchData.sn,callback:function(a){e.$set(e.searchData,"sn",a)},expression:"searchData.sn"}})],1),t("el-form-item",[t("el-input",{staticClass:"handle-input",attrs:{placeholder:"状态",clearable:""},model:{value:e.searchData.status,callback:function(a){e.$set(e.searchData,"status",a)},expression:"searchData.status"}})],1),t("el-form-item",[t("el-input",{staticClass:"handle-input",attrs:{placeholder:"pxe_server_ip",clearable:""},model:{value:e.searchData.pxe_server_ip,callback:function(a){e.$set(e.searchData,"pxe_server_ip",a)},expression:"searchData.pxe_server_ip"}})],1),t("el-button",{staticClass:"handle-box",attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.handleSearch}},[e._v("查询")])],1)],1),t("el-row",[t("el-col",{attrs:{span:30,inline:!0}},[t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.exportData}},[e._v("导出Excel ")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-table",{ref:"ostable",staticStyle:{width:"100%"},attrs:{data:e.row.job_check,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"mac",label:"mac",align:"center"}}),t("el-table-column",{attrs:{prop:"switch",label:"switch",align:"center"}}),t("el-table-column",{attrs:{prop:"port",label:"port",align:"center"}}),t("el-table-column",{attrs:{prop:"ifname",label:"ifname",align:"center",width:"150px"}}),t("el-table-column",{attrs:{prop:"vlan",label:"vlan",align:"center"}})],1)]}}])}),t("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),t("af-table-column",{attrs:{prop:"device_name",label:"设备名",align:"center"}}),t("af-table-column",{attrs:{prop:"hostname",label:"主机名",align:"center"}}),t("af-table-column",{attrs:{prop:"sn",label:"sn",align:"center"}}),t("af-table-column",{attrs:{prop:"status",label:"状态",align:"center",width:"100px"}}),t("af-table-column",{attrs:{prop:"usage",label:"用途",align:"center"}}),t("af-table-column",{attrs:{prop:"console_ip",label:"console_ip",align:"center"}}),t("af-table-column",{attrs:{prop:"console_user",label:"console_user",align:"center"}}),t("af-table-column",{attrs:{prop:"pxe_server_ip",label:"pxe_server_ip",align:"center"}}),t("af-table-column",{attrs:{prop:"ipmi_server_ip",label:"ipmi_server_ip",align:"center"}}),t("af-table-column",{attrs:{prop:"location",label:"位置",align:"center"}}),t("af-table-column",{attrs:{prop:"update_time",label:"更新时间",align:"center",formatter:e.dateFormat}})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)])},r=[],l=(t("99af"),t("4160"),t("d81d"),t("159b"),{name:"JobCheckLog",data:function(){return{tableData:[],pageTotal:0,query:{address:"",name:"",pageIndex:1,pageSize:10},searchData:{pxe_server_ip:"",device_name:"",hostname:"",sn:"",status:""},exportDataRes:[],job_check_length:0,loading:!0}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.$http.get("automation/api/job_check/?current_page=".concat(this.query.pageIndex,"&pre_page=").concat(this.query.pageSize,"&sn=").concat(this.searchData.sn,"&device_name=").concat(this.searchData.device_name,"&hostname=").concat(this.searchData.hostname,"&pxe_server_ip=").concat(this.searchData.pxe_server_ip,"&status=").concat(this.searchData.status),{headers:{token:localStorage.getItem("token")}}).then((function(a){e.tableData=a.data["data"],e.pageTotal=a.data["total_count"],e.loading=!1})).catch((function(a){console.log("失败=="+a),e.$message.error(JSON.stringify(a.response.data)),e.loading=!1}))},handleSearch:function(){this.$set(this.query,"pageIndex",1),this.getData()},dateFormat:function(e,a){var t=e[a.property];if(null!=t){var n=new Date(t),r=n.getFullYear(),l=n.getMonth()+1,s=n.getDate(),c=n.getHours(),o=n.getMinutes(),i=n.getSeconds(),p=r+"-"+l+"-"+s+" "+c+":"+o+":"+i;return p}},handlePageChange:function(e){this.$set(this.query,"pageIndex",e),this.getData()},exportData:function(){var e=this;Promise.all([t.e("chunk-54a55fd6"),t.e("chunk-14c0af1e"),t.e("chunk-081d6fe4")]).then(function(){var a=t("39a0"),n=a.export_json_to_excel,r=["设备名","主机名","sn","status","pxe_server_ip","ipmi_server_ip","位置","console_ip","console_user","用途","更新时间"],l=["device_name","hostname","sn","status","pxe_server_ip","ipmi_server_ip","location","console_ip","console_user","usage","update_time"];e.$http.get("automation/api/job_check/",{headers:{token:localStorage.getItem("token")}}).then((function(a){e.exportDataRes=a.data,console.log(e.exportDataRes)})).then((function(){var a=e.exportDataRes,t=e.formatJson(l,a);console.log(t,9999999);for(var s=["mac","switch","port","ifname","vlan"],c=[],o=0;o<e.job_check_length;o++)c=c.concat(s);console.log(c);var i=r.concat(c);n(i,t,"端口检查结果")}))}.bind(null,t)).catch(t.oe)},formatJson:function(e,a){var t=this,n=[];return a.map((function(a){var r=e.map((function(e){return a[e]})),l=a.job_check.length;l>t.job_check_length&&(t.job_check_length=l);var s=[];a.job_check.forEach((function(e){s.push(e.mac),s.push(e.switch),s.push(e.port),s.push(e.ifname),s.push(e.vlan)}));var c=r.concat(s);n.push(c)})),console.log(n,7777777),n}}}),s=l,c=t("2877"),o=Object(c["a"])(s,n,r,!1,null,"30358c3d",null);a["default"]=o.exports},d81d:function(e,a,t){"use strict";var n=t("23e7"),r=t("b727").map,l=t("1dde"),s=t("ae40"),c=l("map"),o=s("map");n({target:"Array",proto:!0,forced:!c||!o},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);