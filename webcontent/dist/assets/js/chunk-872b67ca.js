(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-872b67ca"],{"1a89":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 物理机装机 ")])],1)],1),a("div",{staticClass:"container"},[a("el-form",{attrs:{inline:!0}},[a("el-row",{staticClass:"margin_bot"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"mr10",attrs:{type:"info",plain:""},on:{click:e.exportTemplate}},[e._v("下载模版 ")])],1),a("el-col",{attrs:{span:18}},[a("el-upload",{ref:"uploadExcel",staticClass:"upload-demo inlineB",attrs:{action:"no",limit:1,"on-change":e.fileChange,"auto-upload":!1}},[a("el-button",{staticClass:"mr10",attrs:{slot:"trigger",size:"small",type:"warning",plain:""},slot:"trigger"},[e._v("选择文件")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"pxe_server"}},[a("el-select",{staticClass:"handle-input",attrs:{"value-key":"id",placeholder:"请选择pxe server",clearable:""},on:{focus:e.queryPxeserver},model:{value:e.pxe_server_id,callback:function(t){e.pxe_server_id=t},expression:"pxe_server_id"}},e._l(e.pxeData,(function(e){return a("el-option",{key:e.id,attrs:{label:"name:"+e.pxe_name+" ip:"+e.pxe_server_ip+" 用途:"+e.device_usage,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"os"}},[a("el-select",{staticClass:"handle-input",attrs:{"value-key":"id",placeholder:"请选择os",clearable:""},on:{focus:e.queryPxeserveros},model:{value:e.os_id,callback:function(t){e.os_id=t},expression:"os_id"}},e._l(e.osData,(function(e){return a("el-option",{key:e.id,attrs:{label:"name:"+e.os_name+" version:"+e.os_version,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"用途"}},[a("el-input",{attrs:{clearable:""},model:{value:e.usage,callback:function(t){e.usage=t},expression:"usage"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.uploadExcel}},[e._v("添加")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addjobinstall}},[e._v("创建")])],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isShowSwitch,expression:"isShowSwitch"}]},[a("el-row",[a("el-form-item",{attrs:{label:"switch"}},[a("el-checkbox-group",{model:{value:e.checkswitchList,callback:function(t){e.checkswitchList=t},expression:"checkswitchList"}},e._l(e.switch_list,(function(t){return a("el-checkbox",{key:t,attrs:{label:t}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1),a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:e.matchmac}},[e._v("确 定")])],1)],1)],1)],1),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-key":e.getRowKeys,"row-class-name":e.tableRowClassName},on:{"selection-change":e.selectionChange}},[a("el-table-column",{attrs:{fixed:"",width:"50",type:"selection",align:"center",selectable:e.selecttable}}),a("af-table-column",{attrs:{prop:"ip",label:"ip",align:"center"}}),a("af-table-column",{attrs:{prop:"device_netmask",label:"netmask",align:"center"}}),a("af-table-column",{attrs:{prop:"device_gateway",label:"gateway",align:"center"}}),a("af-table-column",{attrs:{prop:"hostname",label:"主机名",align:"center"}}),a("af-table-column",{attrs:{prop:"usage",label:"usage",align:"center"}}),a("af-table-column",{attrs:{prop:"manage_address",label:"console_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"device_sn",label:"sn",align:"center"}}),a("af-table-column",{attrs:{prop:"pxe_server_ip",label:"pxe_server_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"ipmi_server_ip",label:"ipmi_server_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"os_name",label:"os_name",align:"center"}}),a("af-table-column",{attrs:{prop:"os_version",label:"os_version",align:"center"}}),a("af-table-column",{attrs:{prop:"status",label:"status",align:"center",formatter:e.formatStatus}}),a("el-table-column",{attrs:{prop:"mac",label:"mac",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.mac,(function(t,i){return a("div",{key:i},[e._v(" "+e._s(t)+" ")])})),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row,t.$index)}}},[e._v("编辑 ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handledelete(t.row)}}},[e._v("删除 ")])]}}])})],1)],1),a("el-dialog",{staticClass:"alert_dialog",attrs:{title:"修改mac",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"all_mac_list",attrs:{model:e.all_mac_list,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"mac"}},[a("el-checkbox-group",{model:{value:e.checkmacList,callback:function(t){e.checkmacList=t},expression:"checkmacList"}},e._l(e.all_mac_list,(function(t){return a("el-checkbox",{key:t,attrs:{label:t}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},s=[],n=(a("a630"),a("c975"),a("45fc"),a("a434"),a("b0c0"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),{name:"JobInstall",data:function(){return{tableData:[],pxeData:[],osData:[],pxe_server_id:"",os_id:"",usage:"",file:"",filename:"",checkList:[],select_color:!1,checkswitchList:[],ports:[],switch_list:[],mac_list:[],ifname_list:[],all_mac_list:[],editVisible:!1,checkmacList:[],index:0,isShowSwitch:!1}},methods:{queryPxeserver:function(){var e=this;this.$http.get("automation/api/pxe_server/?ifenable=enabled",{headers:{token:localStorage.getItem("token")}}).then((function(t){e.pxeData=t.data})).catch((function(t){console.log("失败=="+t),e.$message.error(JSON.stringify(t.response.data))}))},queryPxeserveros:function(){var e=this;this.pxe_server_id?this.$http.get("automation/api/pxe_server_os/?pxe_server_id=".concat(this.pxe_server_id,"&ifenable=enabled"),{headers:{token:localStorage.getItem("token")}}).then((function(t){e.osData=t.data})).catch((function(t){console.log("失败=="+t),e.$message.error(JSON.stringify(t.response.data))})):this.$message.error("请先选择pxe server")},fileChange:function(e){this.file=e.raw,this.filename=e.name},uploadExcel:function(){var e=this,t=new FormData;t.append("pxe_server_id",this.pxe_server_id),t.append("file",this.file),t.append("file_name",this.filename),t.append("os_id",this.os_id),t.append("usage",this.usage),this.$http.post("automation/api/pxe_server/upload_excel/",t,{headers:{token:localStorage.getItem("token")}}).then((function(t){e.tableData=t.data,console.log("Response:"+JSON.stringify(t));var a=[];e.tableData.some((function(t){var i=[];t.port&&t.port.some((function(e){a.push(e.switch),i.push(e.mac)})),e.$set(t,"mac_list",i)})),e.switch_list=Array.from(new Set(a))})).catch((function(t){console.log("Error"+t.response),e.$message.error(JSON.stringify(t.response.data))}))},getRowKeys:function(e){return e.hostname},selectionChange:function(e){this.checkList=e},handledelete:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){t.tableData.some((function(a,i){if(a.hostname==e.hostname)return t.tableData.splice(i,1),console.log(t.tableData),!0}))}))},addjobinstall:function(){var e=this;""==this.pxe_server_id||""==this.os_id||""==this.usage?this.$message.warning("请把选项添加完整再创建！"):(this.isShowSwitch=!0,this.$http.post("automation/api/job_install/",this.checkList,{headers:{token:localStorage.getItem("token")}}).then((function(t){e.$message.success(t.data["msg"]),e.$refs.uploadExcel.clearFiles(),e.tableData=[],e.usage="",e.os_id="",e.pxe_server_id="",e.file="",e.file_name="",e.checkswitchList=[],e.switch_list=[]})).catch((function(t){console.log("失败=="+t),e.$message.error(JSON.stringify(t.response.data))})))},exportTemplate:function(){Promise.all([a.e("chunk-54a55fd6"),a.e("chunk-14c0af1e"),a.e("chunk-2d0aa9b6")]).then(function(){var e=a("39a0"),t=e.export_json_to_excel,i=["ip","hostname","netmask","gateway"],s=[];t(i,s,"装机模版")}.bind(null,a)).catch(a.oe)},formatStatus:function(e){return 1e4==e.status?"端口检查成功":"10001"==e.status?"正在端口检查":"10002"==e.status?"端口检查过期":"10003"==e.status?"端口检查失败":"10004"==e.status?"未端口检查":"未知"},selecttable:function(e){return 1e4===e.status},tableRowClassName:function(e){var t=e.row;return 1e4!==t.status?"select_color":""},matchmac:function(){var e=this;this.tableData.some((function(t){e.mac=[],e.ifname_list=[],t.port&&t.port.some((function(t){var a=e.checkswitchList.indexOf(t.switch);a>=0&&(e.mac.push(t.mac),e.ifname_list.push(t.ifname))})),e.$set(t,"mac",e.mac),e.$set(t,"ifname",e.ifname_list)})),console.log(this.tableData)},handleEdit:function(e,t){this.index=t,this.editVisible=!0,this.all_mac_list=e.mac_list,e.mac?this.checkmacList=e.mac:this.checkmacList=[]},saveEdit:function(){this.$set(this.tableData[this.index],"mac",this.checkmacList),this.editVisible=!1}}}),r=n,o=(a("8792"),a("2877")),l=Object(o["a"])(r,i,s,!1,null,"bf97b404",null);t["default"]=l.exports},"45fc":function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").some,n=a("a640"),r=a("ae40"),o=n("some"),l=r("some");i({target:"Array",proto:!0,forced:!o||!l},{some:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},6062:function(e,t,a){"use strict";var i=a("6d61"),s=a("6566");e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),s)},6566:function(e,t,a){"use strict";var i=a("9bf2").f,s=a("7c73"),n=a("e2cc"),r=a("0366"),o=a("19aa"),l=a("2266"),c=a("7dd0"),u=a("2626"),f=a("83ab"),d=a("f183").fastKey,p=a("69f3"),h=p.set,m=p.getterFor;e.exports={getConstructor:function(e,t,a,c){var u=e((function(e,i){o(e,u,t),h(e,{type:t,index:s(null),first:void 0,last:void 0,size:0}),f||(e.size=0),void 0!=i&&l(i,e[c],e,a)})),p=m(t),v=function(e,t,a){var i,s,n=p(e),r=b(e,t);return r?r.value=a:(n.last=r={index:s=d(t,!0),key:t,value:a,previous:i=n.last,next:void 0,removed:!1},n.first||(n.first=r),i&&(i.next=r),f?n.size++:e.size++,"F"!==s&&(n.index[s]=r)),e},b=function(e,t){var a,i=p(e),s=d(t);if("F"!==s)return i.index[s];for(a=i.first;a;a=a.next)if(a.key==t)return a};return n(u.prototype,{clear:function(){var e=this,t=p(e),a=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete a[i.index],i=i.next;t.first=t.last=void 0,f?t.size=0:e.size=0},delete:function(e){var t=this,a=p(t),i=b(t,e);if(i){var s=i.next,n=i.previous;delete a.index[i.index],i.removed=!0,n&&(n.next=s),s&&(s.previous=n),a.first==i&&(a.first=s),a.last==i&&(a.last=n),f?a.size--:t.size--}return!!i},forEach:function(e){var t,a=p(this),i=r(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:a.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),n(u.prototype,a?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),f&&i(u.prototype,"size",{get:function(){return p(this).size}}),u},setStrong:function(e,t,a){var i=t+" Iterator",s=m(t),n=m(i);c(e,t,(function(e,t){h(this,{type:i,target:e,state:s(e),kind:t,last:void 0})}),(function(){var e=n(this),t=e.kind,a=e.last;while(a&&a.removed)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),u(t)}}},"6d61":function(e,t,a){"use strict";var i=a("23e7"),s=a("da84"),n=a("94ca"),r=a("6eeb"),o=a("f183"),l=a("2266"),c=a("19aa"),u=a("861d"),f=a("d039"),d=a("1c7e"),p=a("d44e"),h=a("7156");e.exports=function(e,t,a){var m=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),b=m?"set":"add",_=s[e],g=_&&_.prototype,x=_,w={},k=function(e){var t=g[e];r(g,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:function(e,a){return t.call(this,0===e?0:e,a),this})};if(n(e,"function"!=typeof _||!(v||g.forEach&&!f((function(){(new _).entries().next()})))))x=a.getConstructor(t,e,m,b),o.REQUIRED=!0;else if(n(e,!0)){var y=new x,S=y[b](v?{}:-0,1)!=y,D=f((function(){y.has(1)})),C=d((function(e){new _(e)})),E=!v&&f((function(){var e=new _,t=5;while(t--)e[b](t,t);return!e.has(-0)}));C||(x=t((function(t,a){c(t,x,e);var i=h(new _,t,x);return void 0!=a&&l(a,i[b],i,m),i})),x.prototype=g,g.constructor=x),(D||E)&&(k("delete"),k("has"),m&&k("get")),(E||S)&&k(b),v&&g.clear&&delete g.clear}return w[e]=x,i({global:!0,forced:x!=_},w),p(x,e),v||a.setStrong(x,e,m),x}},7156:function(e,t,a){var i=a("861d"),s=a("d2bb");e.exports=function(e,t,a){var n,r;return s&&"function"==typeof(n=t.constructor)&&n!==a&&i(r=n.prototype)&&r!==a.prototype&&s(e,r),e}},8792:function(e,t,a){"use strict";var i=a("fae0"),s=a.n(i);s.a},a434:function(e,t,a){"use strict";var i=a("23e7"),s=a("23cb"),n=a("a691"),r=a("50c4"),o=a("7b0b"),l=a("65f0"),c=a("8418"),u=a("1dde"),f=a("ae40"),d=u("splice"),p=f("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,m=Math.min,v=9007199254740991,b="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d||!p},{splice:function(e,t){var a,i,u,f,d,p,_=o(this),g=r(_.length),x=s(e,g),w=arguments.length;if(0===w?a=i=0:1===w?(a=0,i=g-x):(a=w-2,i=m(h(n(t),0),g-x)),g+a-i>v)throw TypeError(b);for(u=l(_,i),f=0;f<i;f++)d=x+f,d in _&&c(u,f,_[d]);if(u.length=i,a<i){for(f=x;f<g-i;f++)d=f+i,p=f+a,d in _?_[p]=_[d]:delete _[p];for(f=g;f>g-i+a;f--)delete _[f-1]}else if(a>i)for(f=g-i;f>x;f--)d=f+i-1,p=f+a-1,d in _?_[p]=_[d]:delete _[p];for(f=0;f<a;f++)_[f+x]=arguments[f+2];return _.length=g-i+a,u}})},bb2f:function(e,t,a){var i=a("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},f183:function(e,t,a){var i=a("d012"),s=a("861d"),n=a("5135"),r=a("9bf2").f,o=a("90e3"),l=a("bb2f"),c=o("meta"),u=0,f=Object.isExtensible||function(){return!0},d=function(e){r(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},p=function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,c)){if(!f(e))return"F";if(!t)return"E";d(e)}return e[c].objectID},h=function(e,t){if(!n(e,c)){if(!f(e))return!0;if(!t)return!1;d(e)}return e[c].weakData},m=function(e){return l&&v.REQUIRED&&f(e)&&!n(e,c)&&d(e),e},v=e.exports={REQUIRED:!1,fastKey:p,getWeakData:h,onFreeze:m};i[c]=!0},fae0:function(e,t,a){}}]);