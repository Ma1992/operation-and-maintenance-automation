(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e5d5fd3"],{"0fc0":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 端口检查 ")])],1)],1),a("div",{staticClass:"container"},[a("el-form",{attrs:{inline:!0}},[a("el-row",{staticClass:"margin_bot"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"mr10",attrs:{type:"info",plain:""},on:{click:e.exportTemplate}},[e._v("下载模版 ")])],1),a("el-col",{attrs:{span:18}},[a("el-upload",{ref:"uploadExcel",staticClass:"upload-demo inlineB",attrs:{action:"no",limit:1,"on-change":e.fileChange,"auto-upload":!1}},[a("el-button",{staticClass:"mr10",attrs:{slot:"trigger",size:"small",type:"warning",plain:""},slot:"trigger"},[e._v("选择文件")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"pxe_server"}},[a("el-select",{staticStyle:{width:"450px"},attrs:{"value-key":"id",placeholder:"请选择pxe server",clearable:""},on:{focus:e.queryPxeserver},model:{value:e.pxe_server_id,callback:function(t){e.pxe_server_id=t},expression:"pxe_server_id"}},e._l(e.pxeData,(function(e){return a("el-option",{key:e.id,attrs:{label:"name:"+e.pxe_name+" ip:"+e.pxe_server_ip+" 用途:"+e.device_usage,value:e.id}})})),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:e.uploadExcel}},[e._v("添加")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:e.addjobcheck}},[e._v("创建")])],1)],1)],1)],1),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-key":e.getRowKeys},on:{"selection-change":e.selectionChange}},[a("el-table-column",{attrs:{fixed:"",width:"50",type:"selection",align:"center","reserve-selection":!0}}),a("af-table-column",{attrs:{prop:"hostname",label:"主机名",align:"center"}}),a("af-table-column",{attrs:{prop:"usage",label:"用途",align:"center"}}),a("af-table-column",{attrs:{prop:"manage_address",label:"console_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"device_sn",label:"sn",align:"center"}}),a("af-table-column",{attrs:{prop:"pxe_server_ip",label:"pxe_server_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"ipmi_server_ip",label:"ipmi_server_ip",align:"center"}}),a("af-table-column",{attrs:{prop:"location_zone",label:"location",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handledelete(t.row)}}},[e._v("删除 ")])]}}])})],1)],1)])},l=[],r=(a("45fc"),a("a434"),a("b0c0"),{name:"JobCheck",data:function(){return{tableData:[],pxeData:[],pxe_server_id:"",file:"",filename:"",checkList:[]}},methods:{queryPxeserver:function(){var e=this;this.$http.get("automation/api/pxe_server/?ifenable=enabled",{headers:{token:localStorage.getItem("token")}}).then((function(t){e.pxeData=t.data})).catch((function(t){console.log("失败=="+t),e.$message.error(JSON.stringify(t.response.data))}))},fileChange:function(e){this.file=e.raw,this.filename=e.name},uploadExcel:function(){var e=this,t=new FormData;t.append("pxe_server_id",this.pxe_server_id),t.append("file",this.file),t.append("file_name",this.filename),this.$http.post("automation/api/pxe_server/upload_excel/",t,{headers:{token:localStorage.getItem("token")}}).then((function(t){e.tableData=t.data,console.log("Response:"+JSON.stringify(t))})).catch((function(t){console.log("Error"+t.response),e.$message.error(JSON.stringify(t.response.data))}))},getRowKeys:function(e){return e.hostname},selectionChange:function(e){this.checkList=e},handledelete:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){t.tableData.some((function(a,n){if(a.hostname==e.hostname)return t.tableData.splice(n,1),console.log(t.tableData),!0})),t.checkList.some((function(a,n){if(a.hostname==e.hostname)return t.checkList.splice(n,1),console.log(t.tableData),!0}))}))},exportTemplate:function(){Promise.all([a.e("chunk-54a55fd6"),a.e("chunk-14c0af1e"),a.e("chunk-081d6fe4")]).then(function(){var e=a("39a0"),t=e.export_json_to_excel,n=["hostname"],l=[];t(n,l,"端口检查模版")}.bind(null,a)).catch(a.oe)},addjobcheck:function(){var e=this;this.$http.post("automation/api/job_check/",this.checkList,{headers:{token:localStorage.getItem("token")}}).then((function(t){e.$message.success(t.data["msg"]),e.$refs.uploadExcel.clearFiles(),e.tableData=[],e.pxe_server_id="",e.file="",e.file_name=""})).catch((function(t){console.log("失败=="+t),e.$message.error(JSON.stringify(t.response.data))}))}}}),o=r,s=(a("3aba"),a("2877")),i=Object(s["a"])(o,n,l,!1,null,"6d916b14",null);t["default"]=i.exports},"3aba":function(e,t,a){"use strict";var n=a("dc2c"),l=a.n(n);l.a},"45fc":function(e,t,a){"use strict";var n=a("23e7"),l=a("b727").some,r=a("a640"),o=a("ae40"),s=r("some"),i=o("some");n({target:"Array",proto:!0,forced:!s||!i},{some:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}})},a434:function(e,t,a){"use strict";var n=a("23e7"),l=a("23cb"),r=a("a691"),o=a("50c4"),s=a("7b0b"),i=a("65f0"),c=a("8418"),p=a("1dde"),u=a("ae40"),d=p("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,m=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d||!f},{splice:function(e,t){var a,n,p,u,d,f,_=s(this),v=o(_.length),x=l(e,v),k=arguments.length;if(0===k?a=n=0:1===k?(a=0,n=v-x):(a=k-2,n=m(h(r(t),0),v-x)),v+a-n>b)throw TypeError(g);for(p=i(_,n),u=0;u<n;u++)d=x+u,d in _&&c(p,u,_[d]);if(p.length=n,a<n){for(u=x;u<v-n;u++)d=u+n,f=u+a,d in _?_[f]=_[d]:delete _[f];for(u=v;u>v-n+a;u--)delete _[u-1]}else if(a>n)for(u=v-n;u>x;u--)d=u+n-1,f=u+a-1,d in _?_[f]=_[d]:delete _[f];for(u=0;u<a;u++)_[u+x]=arguments[u+2];return _.length=v-n+a,p}})},dc2c:function(e,t,a){}}]);